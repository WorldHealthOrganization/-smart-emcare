map 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureMap/emcare.b7-9.lti-dangersigns' = 'emcare.b7-9.lti-dangersigns'
uses 'http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaireresponse' alias 'questionnaireResponse' as source
uses 'http://hl7.org/fhir/StructureDefinition/Bundle' alias 'Bundle' as target
uses 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/observation' alias 'Observation' as target
uses 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation' alias 'EmCare Observation' as produced
group bundletrans(source src : questionnaireResponse,target bundle : Bundle){
    src -> bundle.id = uuid() 'id';
    src -> bundle.type = 'batch' 'type';
    src.item first as itm1  where linkId =  'LTI' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE01' and answer.exists() then {
            src -> bundle.entry as entry  then {
                src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
                src -> entry.resource = create('Observation') as tgt then {
                    src -> tgt then emcareobservationemcareb7de01(src, tgt) '85f0efbc';
                } '839aef8c';
            } '3c5d6594';
        } '7eb55e20';
    } '4b77598a';
    src.item first as itm1  where linkId =  'LTI' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE01-tt' and answer.exists() then {
            src -> bundle.entry as entry  then {
                src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
                src -> entry.resource = create('Observation') as tgt then {
                    src -> tgt then emcareobservationemcareb7de01tt(src, tgt) 'a585ff9e';
                } '15db4339';
            } '0125a84f';
        } 'ca7c8092';
    } 'aa62c848';
    src.item first as itm1  where linkId =  'LTI' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE02' and answer.exists() then {
            src -> bundle.entry as entry  then {
                src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
                src -> entry.resource = create('Observation') as tgt then {
                    src -> tgt then emcareobservationemcareb7de02(src, tgt) '004b4d1e';
                } '92e7f5f9';
            } '402826af';
        } '73f1bfc5';
    } '8272a09c';
    src.item first as itm1  where linkId =  'LTI' then {
        itm1.item first as item  where linkId =  'EmCare.B7.B8.B9.DE01' and answer.exists() then {
            src -> bundle.entry as entry  then {
                src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
                src -> entry.resource = create('Observation') as tgt then {
                    src -> tgt then emcareobservationemcareb7b8b9de01(src, tgt) 'ff2fa2ef';
                } 'a8c4cecd';
            } 'cab32791';
        } 'cde84b84';
    } '18747955';
    src.item first as itm1  where linkId =  'ds' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE03' and answer.exists() then {
            src -> bundle.entry as entry  then {
                src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
                src -> entry.resource = create('Observation') as tgt then {
                    src -> tgt then emcareobservationemcareb7de03(src, tgt) 'f2e89805';
                } '8dded58a';
            } '6d815194';
        } 'b1580360';
    } '917640cc';
    src.item first as itm1  where linkId =  'ds' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE04' and answer.exists() then {
            src -> bundle.entry as entry  then {
                src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
                src -> entry.resource = create('Observation') as tgt then {
                    src -> tgt then emcareobservationemcareb7de04(src, tgt) 'b201520d';
                } '28396086';
            } '4b599b3b';
        } 'bce47b84';
    } '5057e3af';
    src.item first as itm1  where linkId =  'ds' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE07' and answer.exists() then {
            src -> bundle.entry as entry  then {
                src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
                src -> entry.resource = create('Observation') as tgt then {
                    src -> tgt then emcareobservationemcareb7de07(src, tgt) '01add8ac';
                } '57e3e2c9';
            } 'a4bf6e2e';
        } '5597aeef';
    } 'a965f6a6';
    src.item first as itm1  where linkId =  'ds' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE08' and answer.exists() then {
            src -> bundle.entry as entry  then {
                src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
                src -> entry.resource = create('Observation') as tgt then {
                    src -> tgt then emcareobservationemcareb7de08(src, tgt) '279d6969';
                } '20cc88b6';
            } '3f40ba3d';
        } '350d6fc4';
    } 'c3441a00';
    src.item first as itm1  where linkId =  'ds' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE09' and answer.exists() then {
            src -> bundle.entry as entry  then {
                src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
                src -> entry.resource = create('Observation') as tgt then {
                    src -> tgt then emcareobservationemcareb7de09(src, tgt) '3f6a9726';
                } '2c4ac41f';
            } '98869034';
        } '0ea146b2';
    } '5b6d015e';
    src.item first as itm1  where linkId =  'ds' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE10' and answer.exists() then {
            src -> bundle.entry as entry  then {
                src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
                src -> entry.resource = create('Observation') as tgt then {
                    src -> tgt then emcareobservationemcareb7de10(src, tgt) '1fe53b0d';
                } '0fb952bc';
            } '980ae740';
        } '5b813bca';
    } 'e35ba5fb';
}

group emcareobservationemcareb7de01(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb7de01';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B7.DE01'
         'code-emcareb7de01';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as itm1  where linkId =  'LTI' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE01' and answer.exists() then {
            item.answer first as a then {
                a  where a.value = true -> tgt.status = 'final', tgt.value = true 'final-emcareb7de01';
                a  where a.value = false -> tgt.status = 'cancelled', tgt.value = false 'notfound-emcareb7de01';
            } 'bdab9370';
        } '4fe5684a';
    } 'e94a1dc2';
}

group emcareobservationemcareb7de01tt(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb7de01tt';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B7.DE01-tt'
         'code-emcareb7de01tt';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as itm1  where linkId =  'LTI' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE01-tt' and answer.exists() then {
            item.answer first as a then {
                a  where a.value = true -> tgt.status = 'final', tgt.value = true 'final-emcareb7de01tt';
                a  where a.value = false -> tgt.status = 'cancelled', tgt.value = false 'notfound-emcareb7de01tt';
            } 'bdab9370';
        } 'ce6bc92d';
    } 'eff72185';
}

group emcareobservationemcareb7de02(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb7de02';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B7.DE02'
         'code-emcareb7de02';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as itm1  where linkId =  'LTI' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE02' and answer.exists() then {
            item.answer first as a then {
                a  where a.value = true -> tgt.status = 'final', tgt.value = true 'final-emcareb7de02';
                a  where a.value = false -> tgt.status = 'cancelled', tgt.value = false 'notfound-emcareb7de02';
            } 'bdab9370';
        } '16e8520f';
    } '8f315784';
}

group emcareobservationemcareb7b8b9de01(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb7b8b9de01';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B7.B8.B9.DE01'
         'code-emcareb7b8b9de01';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as itm1  where linkId =  'LTI' then {
        itm1.item first as item  where linkId =  'EmCare.B7.B8.B9.DE01' and answer.exists() then {
            item.answer first as a then {
                a.value as val then {
                    val where val.code = 'none' -> tgt.status = 'cancelled' '8ab1d7a5';
                    val where val.code != 'none' -> tgt.value = create('CodeableConcept') as cc, cc.coding = val, tgt.status = 'final' 'a1050460';
                } '4ca9082e';
            } '7c587a4b';
        } '23d33516';
    } '4cb37be3';
}

group emcareobservationemcareb7de03(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb7de03';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B7.DE03'
         'code-emcareb7de03';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as itm1  where linkId =  'ds' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE03' and answer.exists() then {
            item.answer first as a then {
                a  where a.value = true -> tgt.status = 'final', tgt.value = true 'final-emcareb7de03';
                a  where a.value = false -> tgt.status = 'cancelled', tgt.value = false 'notfound-emcareb7de03';
            } 'bdab9370';
        } 'a2c65533';
    } '117b94b7';
}

group emcareobservationemcareb7de04(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb7de04';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B7.DE04'
         'code-emcareb7de04';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as itm1  where linkId =  'ds' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE04' and answer.exists() then {
            item.answer first as a then {
                a.value as val then {
                    val where val.code = 'none' -> tgt.status = 'cancelled' '8ab1d7a5';
                    val where val.code != 'none' -> tgt.value = create('CodeableConcept') as cc, cc.coding = val, tgt.status = 'final' 'a1050460';
                } '4ca9082e';
            } '7c587a4b';
        } '845a8bfd';
    } '5e40888d';
}

group emcareobservationemcareb7de07(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb7de07';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B7.DE07'
         'code-emcareb7de07';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as itm1  where linkId =  'ds' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE07' and answer.exists() then {
            item.answer first as a then {
                a  where a.value = true -> tgt.status = 'final', tgt.value = true 'final-emcareb7de07';
                a  where a.value = false -> tgt.status = 'cancelled', tgt.value = false 'notfound-emcareb7de07';
            } 'bdab9370';
        } 'bf7600eb';
    } '58ba097d';
}

group emcareobservationemcareb7de08(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb7de08';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B7.DE08'
         'code-emcareb7de08';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as itm1  where linkId =  'ds' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE08' and answer.exists() then {
            item.answer first as a then {
                a  where a.value = true -> tgt.status = 'final', tgt.value = true 'final-emcareb7de08';
                a  where a.value = false -> tgt.status = 'cancelled', tgt.value = false 'notfound-emcareb7de08';
            } 'bdab9370';
        } '2bfe418a';
    } '7ef5438a';
}

group emcareobservationemcareb7de09(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb7de09';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B7.DE09'
         'code-emcareb7de09';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as itm1  where linkId =  'ds' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE09' and answer.exists() then {
            item.answer first as a then {
                a  where a.value = true -> tgt.status = 'final', tgt.value = true 'final-emcareb7de09';
                a  where a.value = false -> tgt.status = 'cancelled', tgt.value = false 'notfound-emcareb7de09';
            } 'bdab9370';
        } 'd2857a7f';
    } 'cbbf523b';
}

group emcareobservationemcareb7de10(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb7de10';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B7.DE10'
         'code-emcareb7de10';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as itm1  where linkId =  'ds' then {
        itm1.item first as item  where linkId =  'EmCare.B7.DE10' and answer.exists() then {
            item.answer first as a then {
                a.value as val then {
                    val where val.code = 'none' -> tgt.status = 'cancelled' '8ab1d7a5';
                    val where val.code != 'none' -> tgt.value = create('CodeableConcept') as cc, cc.coding = val, tgt.status = 'final' 'a1050460';
                } '4ca9082e';
            } '7c587a4b';
        } '44becf30';
    } '2409a830';
}

