{
    "resourceType": "Library",
    "id": "EmCareZScore",
    "url": "https://fhir.dk.swisstph-mis.ch/matchbox/fhir/Library/emcareb6measurements",
    "identifier": [
        {
            "use": "official",
            "value": "EmCareZScore"
        }
    ],
    "version": "0.99.99",
    "name": "EmCareZScore",
    "title": "EmCare.Z.Score",
    "status": "active",
    "type": {
        "coding": [
            {
                "system": "http://hl7.org/fhir/ValueSet/library-type",
                "code": "logic-library"
            }
        ]
    },
    "parameter": [
        {
            "name": "pastweight",
            "use": "out",
            "type": "decimal"
        },
        {
            "name": "patientsex",
            "use": "out",
            "type": "string"
        },
        {
            "name": "ageatpastweight",
            "use": "out",
            "type": "integer"
        },
        {
            "name": "pastweightzscore",
            "use": "out",
            "type": "decimal"
        },
        {
            "name": "pastweightactualised",
            "use": "out",
            "type": "decimal"
        },
        {
            "name": "WAZ",
            "use": "out",
            "type": "decimal"
        }
    ],
    "dataRequirement": [
        {
            "type": "Patient",
            "profile": [
                "http://hl7.org/fhir/StructureDefinition/Patient"
            ]
        }
    ],
    "content": [
        {
            "id": "ig-loader-EmCareZScore.cql",
            "contentType": "text/cql",
            "data": "LyoKQGF1dGhvcjogUGF0cmljayBEZWxjcm9peApAZGVzY3JpcHRpb246IFRoaXMgbGlicmFyeSBpcyBwYXJ0IG9mIHRoZSBwcm9qZWN0IEVtQ2FyZQoqLwpsaWJyYXJ5IEVtQ2FyZVpTY29yZSB2ZXJzaW9uICcwLjk5Ljk5Jwp1c2luZyBGSElSIHZlcnNpb24gJzQuMC4xJwppbmNsdWRlIEZISVJIZWxwZXJzIHZlcnNpb24gJzQuMC4xJyBjYWxsZWQgRkhJUkhlbHBlcnMgCmluY2x1ZGUgRW1DYXJlQmFzZSB2ZXJzaW9uICcwLjk5Ljk5JyBjYWxsZWQgQmFzZQppbmNsdWRlIFdlaWdodEZvckFnZSB2ZXJzaW9uICcwLjk5Ljk5JyBjYWxsZWQgd2VpYW50aHJvCgoKCmNvbnRleHQgRW5jb3VudGVyCmNvbnRleHQgUGF0aWVudAogICAgICAKZGVmaW5lICJXZWlnaHQgY29kZSI6CiAgICBCYXNlLmMoJ0VtQ2FyZS5CNi5ERTA2JykKCi8qIHBhc3R3ZWlnaHQgOiBQcmV2aW91cyBXZWlnaHQqLwpkZWZpbmUgInBhc3R3ZWlnaHQiOgogICAgaWYgQWdlSW5Nb250aHMoKTwgNCBhbmQgQmFzZS5IYXNPYnNIaXN0b3J5KCJXZWlnaHQgY29kZSIsJ2h0dHBzOi8vZmhpci5kay5zd2lzc3RwaC1taXMuY2gvbWF0Y2hib3gvZmhpci9Db2RlU3lzdGVtL2VtY2FyZS1jdXN0b20tY29kZXMnLCA2MykgYXMgRkhJUi5RdWFudGl0eSBpcyBub3QgbnVsbCB0aGVuCiAgICAgIEJhc2UuSGFzT2JzSGlzdG9yeSgiV2VpZ2h0IGNvZGUiLCdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvQ29kZVN5c3RlbS9lbWNhcmUtY3VzdG9tLWNvZGVzJywgNjMpICBhcyBGSElSLlF1YW50aXR5CiAgICBlbHNlICBpZiBBZ2VJbk1vbnRocygpPCA2IGFuZCBCYXNlLkhhc09ic0hpc3RvcnkoIldlaWdodCBjb2RlIiwnaHR0cHM6Ly9maGlyLmRrLnN3aXNzdHBoLW1pcy5jaC9tYXRjaGJveC9maGlyL0NvZGVTeXN0ZW0vZW1jYXJlLWN1c3RvbS1jb2RlcycsIDk0KSBhcyBGSElSLlF1YW50aXR5ICBpcyBub3QgbnVsbCB0aGVuCiAgICAgIEJhc2UuSGFzT2JzSGlzdG9yeSgiV2VpZ2h0IGNvZGUiLCdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvQ29kZVN5c3RlbS9lbWNhcmUtY3VzdG9tLWNvZGVzJywgOTQpICBhcyAgRkhJUi5RdWFudGl0eQogICAgZWxzZSBpZiBBZ2VJbk1vbnRocygpPCA2IGFuZCBCYXNlLkhhc09ic0hpc3RvcnkoIldlaWdodCBjb2RlIiwnaHR0cHM6Ly9maGlyLmRrLnN3aXNzdHBoLW1pcy5jaC9tYXRjaGJveC9maGlyL0NvZGVTeXN0ZW0vZW1jYXJlLWN1c3RvbS1jb2RlcycsIDEyNikgYXMgRkhJUi5RdWFudGl0eSAgaXMgbm90IG51bGwgdGhlbgogICAgICAgQmFzZS5IYXNPYnNIaXN0b3J5KCJXZWlnaHQgY29kZSIsJ2h0dHBzOi8vZmhpci5kay5zd2lzc3RwaC1taXMuY2gvbWF0Y2hib3gvZmhpci9Db2RlU3lzdGVtL2VtY2FyZS1jdXN0b20tY29kZXMnLCAxMjYpICBhcyBGSElSLlF1YW50aXR5CiAgICBlbHNlIGlmIEJhc2UuSGFzT2JzSGlzdG9yeSgiV2VpZ2h0IGNvZGUiLCdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvQ29kZVN5c3RlbS9lbWNhcmUtY3VzdG9tLWNvZGVzJywgMjAxKSBhcyBGSElSLlF1YW50aXR5ICBpcyBub3QgbnVsbCB0aGVuCiAgICAgICBCYXNlLkhhc09ic0hpc3RvcnkoIldlaWdodCBjb2RlIiwnaHR0cHM6Ly9maGlyLmRrLnN3aXNzdHBoLW1pcy5jaC9tYXRjaGJveC9maGlyL0NvZGVTeXN0ZW0vZW1jYXJlLWN1c3RvbS1jb2RlcycsIDIwMSkgIGFzIEZISVIuUXVhbnRpdHkKICAgIGVsc2UKICAgICAgbnVsbAoKCi8qIHBhdGllbnRzZXggOiBQYXRpZW50IHNleCovCmRlZmluZSAicGF0aWVudHNleCI6CiAgICBpZiBQYXRpZW50LmdlbmRlciA9ICdmZW1hbGUnIHRoZW4gJ2ZlbWFsZScgZWxzZSAnbWFsZScKCi8qIGFnZWF0cGFzdHdlaWdodCA6IEFnZSBhdCBQcmV2aW91cyBXZWlnaHQqLwpkZWZpbmUgImFnZWF0cGFzdHdlaWdodCI6CiAgICBpZiAicGFzdHdlaWdodCIgaXMgbm90IG51bGwgIHRoZW4KICAgICAgKGRpZmZlcmVuY2UgaW4gZGF5cyBiZXR3ZWVuIFRvRGF0ZShMYXN0KFtPYnNlcnZhdGlvbiBdIE8gd2hlcmUgIE8uc3RhdHVzIGluIHsgJ2ZpbmFsJywgJ2FtZW5kZWQnLCAnY29ycmVjdGVkJ30gYW5kICBleGlzdHMoTy5jb2RlLmNvZGluZyBDIHdoZXJlIEMuY29kZSA9ICJXZWlnaHQgY29kZSIgIGFuZCBDLnN5c3RlbSA9IEZISVIudXJpIHt2YWx1ZSA6ICdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvQ29kZVN5c3RlbS9lbWNhcmUtY3VzdG9tLWNvZGVzJ30pKS5pc3N1ZWQpIGFuZCBQYXRpZW50LmJpcnRoRGF0ZSkgKiAoIDEuMCBhcyBTeXN0ZW0uRGVjaW1hbCApCiAgICBlbHNlCiAgICAgbnVsbAoKLyogcGFzdHdlaWdodHpzY29yZSA6IFotU2NvcmUgYXQgUHJldmlvdXMgV2VpZ2h0Ki8KZGVmaW5lICJwYXN0d2VpZ2h0enNjb3JlIjoKICAgIGlmICJwYXN0d2VpZ2h0IiBpcyBub3QgbnVsbCAgdGhlbgogICAgICB3ZWlhbnRocm8uZ2VuZXJhdGVaU2NvcmVXZWlnaHRGb3JBZ2UoInBhdGllbnRzZXgiLCAiYWdlYXRwYXN0d2VpZ2h0IiAsICgoY29udmVydCAicGFzdHdlaWdodCIgdG8gJ0tnJykudmFsdWUgKiAoIDEuMCBhcyBTeXN0ZW0uRGVjaW1hbCkpKQogICAgZWxzZQogICAgICBudWxsCgovKiB6LXNjb3JlIGF0IHByZXZpb3VzIHdlaWdodCA6IFotU2NvcmUgYXQgUHJldmlvdXMgV2VpZ2h0Ki8KZGVmaW5lICJ6LXNjb3JlIGF0IHByZXZpb3VzIHdlaWdodCI6CiAgICBpZiAicGFzdHdlaWdodCIgaXMgbm90IG51bGwgIHRoZW4KICAgICAgd2VpYW50aHJvLmdlbmVyYXRlWlNjb3JlV2VpZ2h0Rm9yQWdlKCJwYXRpZW50c2V4IiwgImFnZWF0cGFzdHdlaWdodCIgLCAoKGNvbnZlcnQgInBhc3R3ZWlnaHQiIHRvICdLZycpLnZhbHVlICogKCAxLjAgYXMgU3lzdGVtLkRlY2ltYWwgKSkpCiAgICBlbHNlCiAgICAgIG51bGwKCi8qIHBhc3R3ZWlnaHRhY3R1YWxpc2VkIDogV2VpZ2h0IGZyb20gIGF0IFByZXZpb3VzIFdlaWdodCovCmRlZmluZSAicGFzdHdlaWdodGFjdHVhbGlzZWQiOgogICAgaWYgInBhc3R3ZWlnaHQiIGlzIG5vdCBudWxsIHRoZW4KICAgICAgd2VpYW50aHJvLmdlbmVyYXRlV2VpZ2h0RnJvbUFnZSgicGF0aWVudHNleCIsQWdlSW5EYXlzKCkgKiAoIDEuMCBhcyBTeXN0ZW0uRGVjaW1hbCApLCAicGFzdHdlaWdodHpzY29yZSIpCiAgICBlbHNlCiAgICAgIG51bGwKCi8qIHdlaWdodCBmcm9tICBhdCBwcmV2aW91cyB3ZWlnaHQgOiBXZWlnaHQgZnJvbSAgYXQgUHJldmlvdXMgV2VpZ2h0Ki8KZGVmaW5lICJ3ZWlnaHQgZnJvbSAgYXQgcHJldmlvdXMgd2VpZ2h0IjoKICAgIGlmICJwYXN0d2VpZ2h0Ij4wIHRoZW4KICAgICAgd2VpYW50aHJvLmdlbmVyYXRlV2VpZ2h0RnJvbUFnZSgicGF0aWVudHNleCIsQWdlSW5EYXlzKCkgKiAoIDEuMCBhcyBTeXN0ZW0uRGVjaW1hbCApLCAicGFzdHdlaWdodHpzY29yZSIpCiAgICBlbHNlCiAgICAgIG51bGwKCmRlZmluZSAiV0FaIjoKICAgIGlmIEJhc2UuSGFzT2JzKCJXZWlnaHQgY29kZSIsJ2h0dHBzOi8vZmhpci5kay5zd2lzc3RwaC1taXMuY2gvbWF0Y2hib3gvZmhpci9Db2RlU3lzdGVtL2VtY2FyZS1jdXN0b20tY29kZXMnKSA9IEJhc2UuIk5vIiAgIHRoZW4gCiAgICAgICAgInotc2NvcmUgYXQgcHJldmlvdXMgd2VpZ2h0IgogICAgZWxzZSBpZiBCYXNlLkhhc09icygiV2VpZ2h0IGNvZGUiLCdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvQ29kZVN5c3RlbS9lbWNhcmUtY3VzdG9tLWNvZGVzJykgaXMgbm90IG51bGwgdGhlbgogICAgICAgICB3ZWlhbnRocm8uZ2VuZXJhdGVaU2NvcmVXZWlnaHRGb3JBZ2UoInBhdGllbnRzZXgiLCAiYWdlYXRwYXN0d2VpZ2h0IiAsICgoY29udmVydCBCYXNlLkhhc09icygiV2VpZ2h0IGNvZGUiLCdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvQ29kZVN5c3RlbS9lbWNhcmUtY3VzdG9tLWNvZGVzJykgdG8gJ0tnJykudmFsdWUgKiAoIDEuMCBhcyBTeXN0ZW0uRGVjaW1hbCApKSkKICAgIGVsc2UKICAgICAgICBudWxsCgo="
        }
    ]
}