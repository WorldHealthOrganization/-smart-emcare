{
    "resourceType": "Library",
    "id": "EmCareZScore",
    "url": "https://fhir.dk.swisstph-mis.ch/matchbox/fhir/Library/emcareb6measurements",
    "identifier": [
        {
            "use": "official",
            "value": "EmCareZScore"
        }
    ],
    "version": "0.99.99",
    "name": "EmCareZScore",
    "title": "EmCare.Z.Score",
    "status": "active",
    "type": {
        "coding": [
            {
                "system": "http://hl7.org/fhir/ValueSet/library-type",
                "code": "logic-library"
            }
        ]
    },
    "parameter": [
        {
            "name": "pastweight",
            "use": "out",
            "type": "decimal"
        },
        {
            "name": "patientsex",
            "use": "out",
            "type": "string"
        },
        {
            "name": "ageatpastweight",
            "use": "out",
            "type": "integer"
        },
        {
            "name": "pastweightzscore",
            "use": "out",
            "type": "decimal"
        },
        {
            "name": "pastweightactualised",
            "use": "out",
            "type": "decimal"
        },
        {
            "name": "WAZ",
            "use": "out",
            "type": "decimal"
        }
    ],
    "dataRequirement": [
        {
            "type": "Patient",
            "profile": [
                "http://hl7.org/fhir/StructureDefinition/Patient"
            ]
        }
    ],
    "content": [
        {
            "id": "ig-loader-EmCareZScore.cql",
            "contentType": "text/cql",
            "data": "LyoKQGF1dGhvcjogUGF0cmljayBEZWxjcm9peApAZGVzY3JpcHRpb246IFRoaXMgbGlicmFyeSBpcyBwYXJ0IG9mIHRoZSBwcm9qZWN0IEVtQ2FyZQoqLwpsaWJyYXJ5IEVtQ2FyZVpTY29yZSB2ZXJzaW9uICcwLjk5Ljk5Jwp1c2luZyBGSElSIHZlcnNpb24gJzQuMC4xJwppbmNsdWRlIEZISVJIZWxwZXJzIHZlcnNpb24gJzQuMC4xJyBjYWxsZWQgRkhJUkhlbHBlcnMgCmluY2x1ZGUgRW1DYXJlQmFzZSB2ZXJzaW9uICcwLjk5Ljk5JyBjYWxsZWQgQmFzZQppbmNsdWRlIFdlaWdodEZvckFnZSB2ZXJzaW9uICcwLjk5Ljk5JyBjYWxsZWQgd2VpYW50aHJvCgoKCmNvbnRleHQgRW5jb3VudGVyCmNvbnRleHQgUGF0aWVudAogICAgICAKZGVmaW5lICJXZWlnaHQgY29kZSI6CiAgQmFzZS5jb2RpbmcoJ0VtQ2FyZS5CNi5ERTA2JykKCi8qIHBhc3R3ZWlnaHQgOiBQcmV2aW91cyBXZWlnaHQqLwpkZWZpbmUgInBhc3R3ZWlnaHQiOgogICAgaWYgQWdlSW5Nb250aHMoKTwgNCBhbmQgQmFzZS5IYXNPYnNIaXN0b3J5KCJXZWlnaHQgY29kZSIsIDYzKSBhcyBGSElSLlF1YW50aXR5IGlzIG5vdCBudWxsIHRoZW4KICAgICAgQmFzZS5IYXNPYnNIaXN0b3J5KCJXZWlnaHQgY29kZSIsIDYzKSAgYXMgRkhJUi5RdWFudGl0eQogICAgZWxzZSAgaWYgQWdlSW5Nb250aHMoKTwgNiBhbmQgQmFzZS5IYXNPYnNIaXN0b3J5KCJXZWlnaHQgY29kZSIsIDk0KSBhcyBGSElSLlF1YW50aXR5ICBpcyBub3QgbnVsbCB0aGVuCiAgICAgIEJhc2UuSGFzT2JzSGlzdG9yeSgiV2VpZ2h0IGNvZGUiLCA5NCkgIGFzICBGSElSLlF1YW50aXR5CiAgICBlbHNlIGlmIEFnZUluTW9udGhzKCk8IDYgYW5kIEJhc2UuSGFzT2JzSGlzdG9yeSgiV2VpZ2h0IGNvZGUiLCAxMjYpIGFzIEZISVIuUXVhbnRpdHkgIGlzIG5vdCBudWxsIHRoZW4KICAgICAgIEJhc2UuSGFzT2JzSGlzdG9yeSgiV2VpZ2h0IGNvZGUiLCAxMjYpICBhcyBGSElSLlF1YW50aXR5CiAgICBlbHNlIGlmIEJhc2UuSGFzT2JzSGlzdG9yeSgiV2VpZ2h0IGNvZGUiLCAyMDEpIGFzIEZISVIuUXVhbnRpdHkgIGlzIG5vdCBudWxsIHRoZW4KICAgICAgIEJhc2UuSGFzT2JzSGlzdG9yeSgiV2VpZ2h0IGNvZGUiLCAyMDEpICBhcyBGSElSLlF1YW50aXR5CiAgICBlbHNlCiAgICAgIG51bGwKCgovKiBwYXRpZW50c2V4IDogUGF0aWVudCBzZXgqLwpkZWZpbmUgInBhdGllbnRzZXgiOgogICAgaWYgUGF0aWVudC5nZW5kZXIgPSAnZmVtYWxlJyB0aGVuICdmZW1hbGUnIGVsc2UgJ21hbGUnCgovKiBhZ2VhdHBhc3R3ZWlnaHQgOiBBZ2UgYXQgUHJldmlvdXMgV2VpZ2h0Ki8KZGVmaW5lICJhZ2VhdHBhc3R3ZWlnaHQiOgogICAgaWYgInBhc3R3ZWlnaHQiIGlzIG5vdCBudWxsICB0aGVuCiAgICAgIChkaWZmZXJlbmNlIGluIGRheXMgYmV0d2VlbiBUb0RhdGUoTGFzdChbT2JzZXJ2YXRpb246IldlaWdodCBjb2RlIiBdIE8gd2hlcmUgIE8uc3RhdHVzIGluIHsgJ2ZpbmFsJywgJ2FtZW5kZWQnLCAnY29ycmVjdGVkJ30pLmlzc3VlZCkgYW5kIFBhdGllbnQuYmlydGhEYXRlKSAqICggMS4wIGFzIFN5c3RlbS5EZWNpbWFsICkKICAgIGVsc2UKICAgICBudWxsCgovKiBwYXN0d2VpZ2h0enNjb3JlIDogWi1TY29yZSBhdCBQcmV2aW91cyBXZWlnaHQqLwpkZWZpbmUgInBhc3R3ZWlnaHR6c2NvcmUiOgogICAgaWYgInBhc3R3ZWlnaHQiIGlzIG5vdCBudWxsICB0aGVuCiAgICAgIHdlaWFudGhyby5nZW5lcmF0ZVpTY29yZVdlaWdodEZvckFnZSgicGF0aWVudHNleCIsICJhZ2VhdHBhc3R3ZWlnaHQiICwgKChjb252ZXJ0ICJwYXN0d2VpZ2h0IiB0byAnS2cnKS52YWx1ZSAqICggMS4wIGFzIFN5c3RlbS5EZWNpbWFsKSkpCiAgICBlbHNlCiAgICAgIG51bGwKCi8qIHotc2NvcmUgYXQgcHJldmlvdXMgd2VpZ2h0IDogWi1TY29yZSBhdCBQcmV2aW91cyBXZWlnaHQqLwpkZWZpbmUgInotc2NvcmUgYXQgcHJldmlvdXMgd2VpZ2h0IjoKICAgIGlmICJwYXN0d2VpZ2h0IiBpcyBub3QgbnVsbCAgdGhlbgogICAgICB3ZWlhbnRocm8uZ2VuZXJhdGVaU2NvcmVXZWlnaHRGb3JBZ2UoInBhdGllbnRzZXgiLCAiYWdlYXRwYXN0d2VpZ2h0IiAsICgoY29udmVydCAicGFzdHdlaWdodCIgdG8gJ0tnJykudmFsdWUgKiAoIDEuMCBhcyBTeXN0ZW0uRGVjaW1hbCApKSkKICAgIGVsc2UKICAgICAgbnVsbAoKLyogcGFzdHdlaWdodGFjdHVhbGlzZWQgOiBXZWlnaHQgZnJvbSAgYXQgUHJldmlvdXMgV2VpZ2h0Ki8KZGVmaW5lICJwYXN0d2VpZ2h0YWN0dWFsaXNlZCI6CiAgICBpZiAicGFzdHdlaWdodCIgaXMgbm90IG51bGwgdGhlbgogICAgICB3ZWlhbnRocm8uZ2VuZXJhdGVXZWlnaHRGcm9tQWdlKCJwYXRpZW50c2V4IixBZ2VJbkRheXMoKSAqICggMS4wIGFzIFN5c3RlbS5EZWNpbWFsICksICJwYXN0d2VpZ2h0enNjb3JlIikKICAgIGVsc2UKICAgICAgbnVsbAoKLyogd2VpZ2h0IGZyb20gIGF0IHByZXZpb3VzIHdlaWdodCA6IFdlaWdodCBmcm9tICBhdCBQcmV2aW91cyBXZWlnaHQqLwpkZWZpbmUgIndlaWdodCBmcm9tICBhdCBwcmV2aW91cyB3ZWlnaHQiOgogICAgaWYgInBhc3R3ZWlnaHQiPjAgdGhlbgogICAgICB3ZWlhbnRocm8uZ2VuZXJhdGVXZWlnaHRGcm9tQWdlKCJwYXRpZW50c2V4IixBZ2VJbkRheXMoKSAqICggMS4wIGFzIFN5c3RlbS5EZWNpbWFsICksICJwYXN0d2VpZ2h0enNjb3JlIikKICAgIGVsc2UKICAgICAgbnVsbAoKZGVmaW5lICJXQVoiOgogICAgaWYgQmFzZS5IYXNPYnMoIldlaWdodCBjb2RlIikgPSBCYXNlLiJObyIgICB0aGVuIAogICAgICAgICJ6LXNjb3JlIGF0IHByZXZpb3VzIHdlaWdodCIKICAgIGVsc2UgaWYgQmFzZS5IYXNPYnMoIldlaWdodCBjb2RlIikgaXMgbm90IG51bGwgdGhlbgogICAgICAgICB3ZWlhbnRocm8uZ2VuZXJhdGVaU2NvcmVXZWlnaHRGb3JBZ2UoInBhdGllbnRzZXgiLCAiYWdlYXRwYXN0d2VpZ2h0IiAsICgoY29udmVydCBCYXNlLkhhc09icygiV2VpZ2h0IGNvZGUiKSB0byAnS2cnKS52YWx1ZSAqICggMS4wIGFzIFN5c3RlbS5EZWNpbWFsICkpKQogICAgZWxzZQogICAgICAgIG51bGwKCg=="
        }
    ]
}