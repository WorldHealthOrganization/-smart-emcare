{
    "resourceType": "Library",
    "id": "EmCareBase",
    "url": "https://fhir.dk.swisstph-mis.ch/matchbox/fhir/Library/EmCareBase",
    "version": "0.99.99",
    "name": "EmCareBase",
    "title": "EmCareBase",
    "status": "active",
    "type": {
        "coding": [
            {
                "system": "http://hl7.org/fhir/ValueSet/library-type",
                "code": "logic-library"
            }
        ]
    },
    "relatedArtifact": [
        {
            "type": "depends-on",
            "resource": "http://fhir.org/guides/who/anc-cds/Library/FHIRHelpers"
        }
    ],
    "dataRequirement": [
        {
            "type": "Patient",
            "profile": [
                "http://hl7.org/fhir/StructureDefinition/Patient"
            ]
        },
        {
            "type": "Observation",
            "profile": [
                "http://hl7.org/fhir/StructureDefinition/Observation"
            ]
        },
        {
            "type": "Encounter",
            "profile": [
                "http://hl7.org/fhir/StructureDefinition/Encounter"
            ]
        }
    ],
    "content": [
        {
            "id": "ig-loader-EmCareBase.cql",
            "contentType": "text/cql",
            "data": "LyoKQGF1dGhvcjogUGF0cmljayBEZWxjcm9peApAZGVzY3JpcHRpb246IFRoaXMgbGlicmFyeSBpcyBwYXJ0IG9mIHRoZSBwcm9qZWN0IEVtQ2FyZSBQcm9qZWN0LCBpdHMgYWxsb3dzIHN0YW5kYXJkaXNhdGlvbiBmb3IgdGhlIG9ic2VydmF0aW9uIHByb2Nlc3NpbmcKKi8KCmxpYnJhcnkgRW1DYXJlQmFzZSB2ZXJzaW9uICcwLjk5Ljk5JwoKdXNpbmcgRkhJUiB2ZXJzaW9uICc0LjAuMScKCmluY2x1ZGUgRkhJUkhlbHBlcnMgdmVyc2lvbiAnNC4wLjEnCgoKY29udGV4dCBFbmNvdW50ZXIKCi8vICoqKioqKioqKioqKioqKioqKioqKiAgIFBhdGllbnRIYXNPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlciAqKioqKioqKioqKioqKioqKioqKiovCi8vIG9icyBhbmQgdmFsdWUgOiByZXR1cm4gdmFsdWUKLy8gb2JzIGFuZCBubyB2YWx1ZTogcmV0dXJuIHRydWUKLy8gb2JzIGNhbmNlbGxlZCAobm90IGZvdW5kKSA6IHJldHVybiBmYWxzZQovLyBvYnMgbm90IGZvdW5kIDogcmV0dXJuIG51bGwKCmRlZmluZSAiWWVzIjoKICBjb2RpbmcoJ3llcycsICdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvJykKCmRlZmluZSAiTm8iOgogIGNvZGluZygnbm8nLCAnaHR0cHM6Ly9maGlyLmRrLnN3aXNzdHBoLW1pcy5jaC9tYXRjaGJveC9maGlyLycpCgpkZWZpbmUgZnVuY3Rpb24gYXNzZXNPYnNlcnZhdGlvbihPIE9ic2VydmF0aW9uKToKICBjYXNlICAKICAgICAgd2hlbiAgTyA9IG51bGwgdGhlbiBudWxsCiAgICAgIHdoZW4gIE8uc3RhdHVzIGluICB7J2NhbmNlbGxlZCd9IHRoZW4gIk5vIgogICAgICB3aGVuIE8udmFsdWUgaXMgbnVsbCB0aGVuICAiWWVzIgogICAgICB3aGVuIE8udmFsdWUgaXMgRkhJUi5ib29sZWFuIGFuZCBPLnZhbHVlID0gdHJ1ZSB0aGVuICJZZXMiCiAgICAgIHdoZW4gTy52YWx1ZSBpcyBGSElSLmJvb2xlYW4gYW5kIE8udmFsdWUgPSBmYWxzZSB0aGVuICJObyIKICAgICAgZWxzZSBPLnZhbHVlCiAgZW5kCiAgICAgIApkZWZpbmUgZnVuY3Rpb24gR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXIoaWRsaXN0IExpc3Q8Y29kZT4sIGNvZGVzeXN0ZW0gRkhJUi51cmwpOgogIGlmIEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyRG9uZShpZGxpc3QgLCBjb2Rlc3lzdGVtKSBpcyBudWxsIHRoZW4gCiAgICAgIEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyRG9uZShpZGxpc3QgLCBjb2Rlc3lzdGVtICApCiAgZWxzZQogICAgR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXJOb3RGb3VuZChpZGxpc3QgLCBjb2Rlc3lzdGVtICApCgoKZGVmaW5lIGZ1bmN0aW9uIEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyRG9uZShpZGxpc3QgTGlzdDxjb2RlPiwgY29kZXN5c3RlbSBGSElSLnVybCk6CiAgICAgIExhc3QoW09ic2VydmF0aW9uIF0gTwogICAgICAgIHdoZXJlIExhc3QoU3BsaXQoTy5lbmNvdW50ZXIucmVmZXJlbmNlLCAnLycpKSA9IEVuY291bnRlci5pZAogICAgICAgIGFuZCBPLnN0YXR1cyBpbiB7ICdmaW5hbCcsICdhbWVuZGVkJywgJ2NvcnJlY3RlZCd9CiAgICAgICAgYW5kIGV4aXN0cyhPLmNvZGUuY29kaW5nIEMgd2hlcmUgQy5jb2RlIGluIGlkbGlzdCAKICAgICAgICBhbmQgQy5zeXN0ZW0gPSBjb2Rlc3lzdGVtKSkKCgpkZWZpbmUgZnVuY3Rpb24gR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXJOb3RGb3VuZChpZGxpc3QgTGlzdDxjb2RlPiwgY29kZXN5c3RlbSBGSElSLnVybCk6CiAgICAgIExhc3QoW09ic2VydmF0aW9uXSBPCiAgICAgICAgd2hlcmUgTGFzdChTcGxpdChPLmVuY291bnRlci5yZWZlcmVuY2UsICcvJykpID0gRW5jb3VudGVyLmlkCiAgICAgICAgICBhbmQgTy5zdGF0dXMgaW4geydjYW5jZWxsZWQnfQogICAgICAgICAgYW5kIGV4aXN0cyhPLmNvZGUuY29kaW5nIEMgd2hlcmUgQy5jb2RlIGluIGlkbGlzdCAKICAgICAgICAgIGFuZCBDLnN5c3RlbSA9IGNvZGVzeXN0ZW0pKQoKZGVmaW5lIGZ1bmN0aW9uIEdldE51bWJlck9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyKGlkbGlzdCBMaXN0PGNvZGU+LCBjb2Rlc3lzdGVtIEZISVIudXJsKToKICBDb3VudCgKICAgIFtPYnNlcnZhdGlvbl0gTwogICAgICAgIHdoZXJlIExhc3QoU3BsaXQoTy5lbmNvdW50ZXIucmVmZXJlbmNlLCAnLycpKSA9IEVuY291bnRlci5pZAogICAgICAgIGFuZCBPLnN0YXR1cyBpbiB7ICdmaW5hbCcsICdhbWVuZGVkJywgJ2NvcnJlY3RlZCd9CiAgICAgICAgYW5kIGV4aXN0cygoTy5jb2RlLmNvZGluZyBDIHdoZXJlIEMuY29kZSBpbiBpZGxpc3QgCiAgICAgICAgYW5kIEMuc3lzdGVtID0gY29kZXN5c3RlbSkpKQoKZGVmaW5lIGZ1bmN0aW9uIEhhc09icyhpZGxpc3QgTGlzdDxGSElSLmNvZGU+LCBjb2Rlc3lzdGVtIFN5c3RlbS5TdHJpbmcpOgogICAgYXNzZXNPYnNlcnZhdGlvbihHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlcihpZGxpc3QsIFRvVXJsKGNvZGVzeXN0ZW0pKSkKCmRlZmluZSBmdW5jdGlvbiBIYXNPYnMoaWQgRkhJUi5jb2RlLCBjb2Rlc3lzdGVtIFN5c3RlbS5TdHJpbmcpOgogICAgYXNzZXNPYnNlcnZhdGlvbihHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlcih7aWR9LCBUb1VybChjb2Rlc3lzdGVtKSkpCgpkZWZpbmUgZnVuY3Rpb24gSGFzT2JzKGlkIFN5c3RlbS5TdHJpbmcsIGNvZGVzeXN0ZW0gU3lzdGVtLlN0cmluZyk6CiAgICBhc3Nlc09ic2VydmF0aW9uKEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyKHtjKGlkKX0sIFRvVXJsKGNvZGVzeXN0ZW0pKSkKCmRlZmluZSBmdW5jdGlvbiBIYXNPYnMoaWQgU3lzdGVtLlN0cmluZyk6CiAgICBhc3Nlc09ic2VydmF0aW9uKEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyKHtjKGlkKX0sIFRvVXJsKCdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvJykpKQoKCgpkZWZpbmUgZnVuY3Rpb24gR2V0SGlzdG9yaWNPYnNlcnZhdGlvbihpZGxpc3QgTGlzdDxjb2RlPiwgY29kZXN5c3RlbSBGSElSLnVybCwgbmJkYXlzIEludGVnZXIpOgogIGlmIEdldEhpc3RvcmljT2JzZXJ2YXRpb25Ob3Rmb3VuZChpZGxpc3QgLCBjb2Rlc3lzdGVtICwgbmJkYXlzICkgaXMgbnVsbCB0aGVuIAogICAgICBHZXRIaXN0b3JpY09ic2VydmF0aW9uTm90Zm91bmQoaWRsaXN0ICwgY29kZXN5c3RlbSAsIG5iZGF5cyApCiAgZWxzZQogICAgR2V0SGlzdG9yaWNPYnNlcnZhdGlvbk5vdGZvdW5kKGlkbGlzdCAsIGNvZGVzeXN0ZW0gLCBuYmRheXMgKQoKZGVmaW5lIGZ1bmN0aW9uIEdldEhpc3RvcmljT2JzZXJ2YXRpb25Eb25lKGlkbGlzdCBMaXN0PGNvZGU+LCBjb2Rlc3lzdGVtIEZISVIudXJsLCBuYmRheXMgSW50ZWdlcik6CiAgICAgIExhc3QoW09ic2VydmF0aW9uXSBPCiAgICAgICAgd2hlcmUgIE8uc3RhdHVzIGluIHsgJ2ZpbmFsJywgJ2FtZW5kZWQnLCAnY29ycmVjdGVkJ30KICAgICAgICBhbmQgZGlmZmVyZW5jZSBpbiBkYXlzIGJldHdlZW4gTy5pc3N1ZWQgYW5kIFRvZGF5KCkgPCBuYmRheXMKICAgICAgICBhbmQgZXhpc3RzKE8uY29kZS5jb2RpbmcgQyB3aGVyZSBDLmNvZGUgaW4gaWRsaXN0IAogICAgICAgIGFuZCBDLnN5c3RlbSA9IGNvZGVzeXN0ZW0pKQoKZGVmaW5lIGZ1bmN0aW9uIEdldEhpc3RvcmljT2JzZXJ2YXRpb25Ob3Rmb3VuZChpZGxpc3QgTGlzdDxjb2RlPiwgY29kZXN5c3RlbSBGSElSLnVybCwgbmJkYXlzIEludGVnZXIpOgogICAgICBMYXN0KFtPYnNlcnZhdGlvbl0gTwogICAgICAgIHdoZXJlICBPLnN0YXR1cyBpbiB7J2NhbmNlbGxlZCd9CiAgICAgICAgICBhbmQgZGlmZmVyZW5jZSBpbiBkYXlzIGJldHdlZW4gTy5pc3N1ZWQgYW5kIFRvZGF5KCkgPCBuYmRheXMKICAgICAgICAgIGFuZCBleGlzdHMoTy5jb2RlLmNvZGluZyBDIHdoZXJlIEMuY29kZSBpbiBpZGxpc3QgCiAgICAgICAgICBhbmQgQy5zeXN0ZW0gPSBjb2Rlc3lzdGVtKSkKICAKLy8gKioqKioqKioqKioqKioqKioqKioqKioqICAgUGF0aWVudEhhc0hpc3RvcnlPZk9ic2VydmF0aW9uICoqKioqKioqKioqKioqKioqKioqKioqKi8KCgpkZWZpbmUgZnVuY3Rpb24gSGFzT2JzSGlzdG9yeShpZGxpc3QgTGlzdDxGSElSLmNvZGU+LCBjb2Rlc3lzdGVtIFN5c3RlbS5TdHJpbmcsIG5iZGF5cyBJbnRlZ2VyKToKICBhc3Nlc09ic2VydmF0aW9uKEdldEhpc3RvcmljT2JzZXJ2YXRpb24oaWRsaXN0LCBUb1VybChjb2Rlc3lzdGVtKSwgbmJkYXlzKSkKCgpkZWZpbmUgZnVuY3Rpb24gSGFzT2JzSGlzdG9yeShpZCBGSElSLmNvZGUsIGNvZGVzeXN0ZW0gU3lzdGVtLlN0cmluZywgbmJkYXlzIEludGVnZXIpOgogIGFzc2VzT2JzZXJ2YXRpb24oR2V0SGlzdG9yaWNPYnNlcnZhdGlvbih7aWR9LCBUb1VybChjb2Rlc3lzdGVtKSwgbmJkYXlzKSkKCmRlZmluZSBmdW5jdGlvbiBIYXNPYnNIaXN0b3J5KGlkIFN5c3RlbS5TdHJpbmcsIGNvZGVzeXN0ZW0gU3lzdGVtLlN0cmluZywgbmJkYXlzIEludGVnZXIpOgogIGFzc2VzT2JzZXJ2YXRpb24oR2V0SGlzdG9yaWNPYnNlcnZhdGlvbih7YyhpZCl9LCBUb1VybChjb2Rlc3lzdGVtKSwgbmJkYXlzKSkKCgpkZWZpbmUgZnVuY3Rpb24gSGFzT2JzSGlzdG9yeShpZCBTeXN0ZW0uU3RyaW5nLCBuYmRheXMgSW50ZWdlcik6CiAgYXNzZXNPYnNlcnZhdGlvbihHZXRIaXN0b3JpY09ic2VydmF0aW9uKHtjKGlkKX0sIFRvVXJsKCdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvJyksIG5iZGF5cykpCgpkZWZpbmUgZnVuY3Rpb24gYyhzIFN5c3RlbS5TdHJpbmcpOgogIEZISVIuY29kZSB7IHZhbHVlOiBzIH0KCmRlZmluZSBmdW5jdGlvbiBjb2RpbmcocyBTeXN0ZW0uU3RyaW5nLCB1cmwgU3lzdGVtLlN0cmluZyk6CiAgRkhJUi5Db2RpbmcgewogICAgICAgICAgICAgICAgY29kZTogRkhJUi5jb2RlIHsgdmFsdWU6IHMgfSwKICAgICAgICAgICAgICAgIHN5c3RlbTogRkhJUi51cmkgeyB2YWx1ZTogdXJsIH0sCiAgICAgICAgICAgICAgICAiZGlzcGxheSI6IEZISVIuc3RyaW5nIHsgdmFsdWU6IHMgfQogICAgICAgICAgICB9CgpkZWZpbmUgZnVuY3Rpb24gVG9VcmwocyBTeXN0ZW0uU3RyaW5nKToKICB1cmwge3ZhbHVlOnN9Ci8vICoqKioqKioqKioqKioqKioqKioqKioqKiAgIFBhdGllbnRIYXNIaXN0b3J5T2ZDb25kaXRpb24gKioqKioqKioqKioqKioqKioqKioqKioqLwoKZGVmaW5lIGZ1bmN0aW9uIEdldEhpc3RvcmljQ29uZGl0aW9uKGlkbGlzdCBMaXN0PGNvZGU+LCBjb2Rlc3lzdGVtIEZISVIudXJsLCBuYmRheXMgSW50ZWdlcik6CiAgICAgIExhc3QoW0NvbmRpdGlvbl0gTwogICAgICAgIHdoZXJlICBkaWZmZXJlbmNlIGluIGRheXMgYmV0d2VlbiBPLnJlY29yZGVkRGF0ZSBhbmQgVG9kYXkoKSA8IG5iZGF5cwogICAgICAgIGFuZCBleGlzdHMoTy5jb2RlLmNvZGluZyBDIHdoZXJlIEMuY29kZSBpbiBpZGxpc3QgCiAgICAgICAgYW5kIEMuc3lzdGVtID0gY29kZXN5c3RlbSkKICAgICAgICBhbmQgZXhpc3RzKE8udmVyaWZpY2F0aW9uU3RhdHVzLmNvZGluZyBDIHdoZXJlIEMuY29kZSBpbiB7J3VuY29uZmlybWVkJywgJ3Byb3Zpc2lvbmFsJywgJ2RpZmZlcmVudGlhbCcsICdjb25maXJtZWQnfSAKICAgICAgICBhbmQgQy5zeXN0ZW0gPSAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9jb25kaXRpb24tdmVyLXN0YXR1cycpKQoKCmRlZmluZSBmdW5jdGlvbiBhc3Nlc0NvbmRpdGlvbihPIENvbmRpdGlvbik6CiAgaWYgTyBpcyBudWxsIHRoZW4gCiAgICAiTm8iCiAgZWxzZQogICAgIlllcyIKCgpkZWZpbmUgZnVuY3Rpb24gSGFzQ29uZEhpc3RvcnkoaWRsaXN0IExpc3Q8RkhJUi5jb2RlPiwgY29kZXN5c3RlbSBTeXN0ZW0uU3RyaW5nLCBuYmRheXMgSW50ZWdlcik6CiAgYXNzZXNDb25kaXRpb24oR2V0SGlzdG9yaWNDb25kaXRpb24oaWRsaXN0LCBUb1VybChjb2Rlc3lzdGVtKSwgbmJkYXlzKSkKCgpkZWZpbmUgZnVuY3Rpb24gSGFzQ29uZEhpc3RvcnkoaWQgRkhJUi5jb2RlLCBjb2Rlc3lzdGVtIFN5c3RlbS5TdHJpbmcsIG5iZGF5cyBJbnRlZ2VyKToKICBhc3Nlc0NvbmRpdGlvbihHZXRIaXN0b3JpY0NvbmRpdGlvbih7aWR9LCBUb1VybChjb2Rlc3lzdGVtKSwgbmJkYXlzKSkKCmRlZmluZSBmdW5jdGlvbiBIYXNDb25kSGlzdG9yeShpZCBTeXN0ZW0uU3RyaW5nLCBjb2Rlc3lzdGVtIFN5c3RlbS5TdHJpbmcsIG5iZGF5cyBJbnRlZ2VyKToKICBhc3Nlc0NvbmRpdGlvbihHZXRIaXN0b3JpY0NvbmRpdGlvbih7YyhpZCl9LCBUb1VybChjb2Rlc3lzdGVtKSwgbmJkYXlzKSkKCgpkZWZpbmUgZnVuY3Rpb24gSGFzQ29uZEhpc3RvcnkoaWQgU3lzdGVtLlN0cmluZywgbmJkYXlzIEludGVnZXIpOgogIGFzc2VzQ29uZGl0aW9uKEdldEhpc3RvcmljQ29uZGl0aW9uKHtjKGlkKX0sIFRvVXJsKCdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvJyksIG5iZGF5cykpCi8vZGVmaW5lIGZ1bmN0aW9uIFBhdGllbnRIYXNDb25kaXRpb25EdXJpbmdFbmNvdW50ZXIoaWQgU3RyaW5nLCBjb2Rlc3lzdGVtIHVybCwgZHVyYXRpb24gSW50ZWdlcikpOgoKLy9kZWZpbmUgZnVuY3Rpb24gUGF0aWVudEhhc0NvbmRpdGlvbkZyb21WYWx1ZVNldER1cmluZ0VuY291bnRlcihpZCBTdHJpbmcsIGNvZGVzeXN0ZW0gdXJsLCBkdXJhdGlvbiBJbnRlZ2VyKSk6CgovL2RlZmluZSBmdW5jdGlvbiBQYXRpZW50SGFzSHNpc3RvcnlDb25kaXRpb24oaWQgU3RyaW5nLGNvZGVzeXN0ZW0gdXJsICwgZHVyYXRpb24gSW50ZWdlcik6Ci8vZGVmaW5lIGZ1bmN0aW9uIFBhdGllbnRIYXNIc2lzdG9yeUNvbmRpdGlvbkZyb21WYWx1ZVNldChpZCBTdHJpbmcsY29kZXN5c3RlbSB1cmwgLCBkdXJhdGlvbiBJbnRlZ2VyKToKCgovLyBQYXRpZW50SGFzU3ltcHRvbSgic3ltcHRvbSBuYW1lIik6IHN5bXB0b20gaW4gdGhlIGVuY291bnRlcgoKCi8vIFBhdGllbnRMYXN0TWVhc3VyZU9mKCJtZWFzdXJlIG5hbWUiKTogbWVhc3VyZSBpbiB0aGUgZW5jb3VudGVyCgovLyBQYXRpZW50TGFzdEhpc3RvcmljTWVhc3VyZU9mKCJtZWFzdXJlIG5hbWUiLCBkdXJhdGlvbik6IG1lYXN1cmUgaW4gdGhlIHBhdGllbnQgaGlzdG9yeSBkdXJpbmcgZHVyYXRpb24KCi8vIFBhdGllbnRIYXNEaWFnbm9zdGljKCJEaWFnbm9zdGljIG5hbWUiICk6IERpYWdub3N0aWMgaW4gdGhlIGVuY291bnRlcgoKLy8gUGF0aWVudEhhc0hpc3RvcnlPZkRpYWdub3N0aWMoIkRpYWdub3N0aWMgbmFtZSIsIGR1cmF0aW9uICk6IERpYWdub3N0aWMgaW4gdGhlIHBhdGllbnQgaGlzdG9yeSBkdXJpbmcgZHVyYXRpb24KCi8vIFBhdGllbnRIYXNQcm9wb3NlZG9yQ29uZmlybWVkRGlhbm9zdGljKCJEaWFnbm9zdGljIG5hbWUiICk6IERpYWdub3N0aWMgaW4gdGhlIGVuY291bnRlcgoKLy8gUGF0aWVudEhhc0hpc3RvcnlPZlByb3Bvc2Vkb3JDb25maXJtZWREaWFub3N0aWMoIkRpYWdub3N0aWMgbmFtZSIsIGR1cmF0aW9uICk6IERpYWdub3N0aWMgaW4gdGhlIHBhdGllbnQgaGlzdG9yeSBkdXJpbmcgZHVyYXRpb24KCi8vIFBhdGllbnRaU2NvcmVXZkEod2llZ2h0LCBhZ2UpCgovLyBQYXRpZW50V2VpZ2h0RnJvbVdmQShhZ2UsIE11YWMpCg=="
        }
    ]
}