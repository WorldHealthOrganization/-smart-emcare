{
    "resourceType": "Library",
    "id": "EmCareBase",
    "url": "https://fhir.dk.swisstph-mis.ch/matchbox/fhir/Library/EmCareBase",
    "version": "0.99.99",
    "name": "EmCareBase",
    "title": "EmCareBase",
    "status": "active",
    "type": {
        "coding": [
            {
                "system": "http://hl7.org/fhir/ValueSet/library-type",
                "code": "logic-library"
            }
        ]
    },
    "relatedArtifact": [
        {
            "type": "depends-on",
            "resource": "http://fhir.org/guides/who/anc-cds/Library/FHIRHelpers"
        }
    ],
    "parameter": [
        {
            "name": "encounterid",
            "use": "in",
            "type": "string"
        }
    ],
    "dataRequirement": [
        {
            "type": "Patient",
            "profile": [
                "http://hl7.org/fhir/StructureDefinition/Patient"
            ]
        },
        {
            "type": "Encounter",
            "profile": [
                "http://hl7.org/fhir/StructureDefinition/Encounter"
            ]
        }
    ],
    "content": [
        {
            "id": "ig-loader-EmCareBase.cql",
            "contentType": "text/cql",
            "data": "LypudGVyIgpAYXV0aG9yOiBQYXRyaWNrIERlbGNyb2l4CkBkZXNjcmlwdGlvbjogVGhpcyBsaWJyYXJ5IGlzIHBhcnQgb2YgdGhlIHByb2plY3QgRW1DYXJlIFByb2plY3QsIGl0cyBhbGxvd3Mgc3RhbmRhcmRpc2F0aW9uIGZvciB0aGUgb2JzZXJ2YXRpb24gcHJvY2Vzc2luZwoqLwoKbGlicmFyeSBFbUNhcmVCYXNlIHZlcnNpb24gJzAuOTkuOTknCgp1c2luZyBGSElSIHZlcnNpb24gJzQuMC4xJwoKaW5jbHVkZSBGSElSSGVscGVycyB2ZXJzaW9uICc0LjAuMScKCnBhcmFtZXRlciAiZW5jb3VudGVyaWQiIFN0cmluZwovL3BhcmFtZXRlciAiRW5jb3VudGVyIiBFbmNvdW50ZXIKCmNvbnRleHQgUGF0aWVudAoKLy9kZWZpbmUgZW5jb3VudGVyaWQ6Ci8vICAiRW5jb3VudGVyIi5pZAoKCmRlZmluZSAiWWVzIjoKICB0cnVlCgpkZWZpbmUgIk5vIjoKICBmYWxzZSAKCgpkZWZpbmUgZnVuY3Rpb24gSXNJbkVuY291bnRlcihyZWYgRkhJUi5SZWZlcmVuY2UpOgogICAgY2FzZQogICAgd2hlbiBlbmNvdW50ZXJpZCA9IHJlZi5pZCB0aGVuIHRydWUKICAgIHdoZW4gZW5jb3VudGVyaWQgPSBMYXN0KFNwbGl0KHJlZi5yZWZlcmVuY2UsICcvJykpIHRoZW4gdHJ1ZQogICAvLyB3aGVuIHJlZi5pZGVudGlmaWVyIGlzIG5vdCBudWxsIGFuZCBpZCA9IHJlZi5pZGVudGlmaWVyLmlkIHRoZW4gdHJ1ZQogICAgZWxzZSBmYWxzZQplbmQKCgpkZWZpbmUgZnVuY3Rpb24gZ2V0VmFsdWUoTyBPYnNlcnZhdGlvbik6CiAgY2FzZSAgCiAgICAgIHdoZW4gIE8gaXMgbnVsbCB0aGVuIG51bGwKICAgICAgZWxzZSBPLnZhbHVlCiAgZW5kCgoKZGVmaW5lIGZ1bmN0aW9uIGFzc2VzT2JzZXJ2YXRpb24oTyBPYnNlcnZhdGlvbik6CiAgY2FzZSAgCiAgICAgIHdoZW4gIE8gaXMgbnVsbCB0aGVuIG51bGwKICAgICAgd2hlbiAgTy5zdGF0dXMgaW4gIHsnY2FuY2VsbGVkJ30gdGhlbiBmYWxzZQogICAgICB3aGVuIE8udmFsdWUgaXMgbnVsbCB0aGVuICB0cnVlCiAgICAgIGVsc2UgTy52YWx1ZQogIGVuZAovKiAgICAgIApkZWZpbmUgZnVuY3Rpb24gR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXIoaWRsaXN0IExpc3Q8U3lzdGVtLkNvZGU+KToKICBpZiBHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlckRvbmUoaWRsaXN0ICkgaXMgbnVsbCB0aGVuIAogICAgICBHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlckRvbmUoaWRsaXN0ICkKICBlbHNlCiAgICBHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlck5vdEZvdW5kKGlkbGlzdCApCiovCgpkZWZpbmUgZnVuY3Rpb24gR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXIoaWQgU3lzdGVtLkNvZGUpOgogIGlmIEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyRG9uZShpZCApIGlzIG5vdCBudWxsIHRoZW4gCiAgICAgIEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyRG9uZShpZCApCiAgZWxzZQogICAgR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXJOb3RGb3VuZChpZCApCi8qCmRlZmluZSBmdW5jdGlvbiBHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlckRvbmUoaWRsaXN0IExpc3Q8U3lzdGVtLkNvZGU+KToKICAgICAgTGFzdChbT2JzZXJ2YXRpb246IGlkbGlzdCBdIE8KICAgICAgICB3aGVyZSAgIElzSW5FbmNvdW50ZXIoTy5lbmNvdW50ZXIpIAogICAgICAgIGFuZCBPLnN0YXR1cyBpbiB7ICdmaW5hbCcsICdhbWVuZGVkJywgJ2NvcnJlY3RlZCd9KQoqLwpkZWZpbmUgZnVuY3Rpb24gR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXJEb25lKGlkIFN5c3RlbS5Db2RlKToKICAgICAgTGFzdChbT2JzZXJ2YXRpb246IGlkIF0gTwogICAgICAgIHdoZXJlICAgSXNJbkVuY291bnRlcihPLmVuY291bnRlcikgCiAgICAgICAgYW5kIE8uc3RhdHVzIGluIHsgJ2ZpbmFsJywgJ2FtZW5kZWQnLCAnY29ycmVjdGVkJ30pCgovKgpkZWZpbmUgZnVuY3Rpb24gR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXJOb3RGb3VuZChpZGxpc3QgTGlzdDxTeXN0ZW0uQ29kZT4pOgogICAgICBMYXN0KFtPYnNlcnZhdGlvbjogaWRsaXN0XSBPCiAgICAgICB3aGVyZSAgSXNJbkVuY291bnRlcihPLmVuY291bnRlcikgCiAgICAgICAgICBhbmQgTy5zdGF0dXMgaW4geydjYW5jZWxsZWQnfSkKICAgICAgICAgICovCmRlZmluZSBmdW5jdGlvbiBHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlck5vdEZvdW5kKGlkIFN5c3RlbS5Db2RlKToKICAgICAgTGFzdChbT2JzZXJ2YXRpb246IGlkXSBPCiAgICAgICB3aGVyZSAgSXNJbkVuY291bnRlcihPLmVuY291bnRlcikgCiAgICAgICAgICBhbmQgTy5zdGF0dXMgaW4geydjYW5jZWxsZWQnfSkKLyoKCmRlZmluZSBmdW5jdGlvbiBHZXROdW1iZXJPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlcihpZGxpc3QgTGlzdDxTeXN0ZW0uQ29kZT4pOgogIENvdW50KAogICAgW09ic2VydmF0aW9uOiBpZGxpc3RdIE8KICAgICAgICB3aGVyZSAgSXNJbkVuY291bnRlciggTy5lbmNvdW50ZXIpIAogICAgICAgIGFuZCBPLnN0YXR1cyBpbiB7ICdmaW5hbCcsICdhbWVuZGVkJywgJ2NvcnJlY3RlZCd9KQoqLwpkZWZpbmUgZnVuY3Rpb24gR2V0TnVtYmVyT2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXIoaWQgU3lzdGVtLkNvZGUpOgogIENvdW50KAogICAgW09ic2VydmF0aW9uOiBpZF0gTwogICAgICAgIHdoZXJlICBJc0luRW5jb3VudGVyKCBPLmVuY291bnRlcikgCiAgICAgICAgYW5kIE8uc3RhdHVzIGluIHsgJ2ZpbmFsJywgJ2FtZW5kZWQnLCAnY29ycmVjdGVkJ30pCgovLyAqKioqKioqKioqKioqKioqKioqKioqKiogICBHZXRPYnNWYWx1ZSAqKioqKioqKioqKioqKioqKioqKioqKiovCi8qCmRlZmluZSBmdW5jdGlvbiBHZXRPYnNWYWx1ZShpZGxpc3QgTGlzdDxTeXN0ZW0uQ29kZT4pOgogICAgZ2V0VmFsdWUoR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXIoaWRsaXN0KSkKCmRlZmluZSBmdW5jdGlvbiBHZXRPYnNWYWx1ZShpZCBTeXN0ZW0uQ29kZSk6CiAgICBnZXRWYWx1ZShHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlcih7aWR9KSkKKi8KCmRlZmluZSBmdW5jdGlvbiBHZXRPYnNWYWx1ZShpZCBTeXN0ZW0uQ29kZSk6CiAgICBnZXRWYWx1ZShHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlcihpZCkpCgpkZWZpbmUgZnVuY3Rpb24gR2V0T2JzVmFsdWUoaWQgU3lzdGVtLlN0cmluZywgY29kZXN5c3RlbSBTeXN0ZW0uU3RyaW5nKToKICAgIGdldFZhbHVlKEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyKGNvZGluZyhpZCwgY29kZXN5c3RlbSkpKQoKZGVmaW5lIGZ1bmN0aW9uIEdldE9ic1ZhbHVlKGlkIFN5c3RlbS5TdHJpbmcpOgogICAgZ2V0VmFsdWUoR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXIoY29kaW5nKGlkLCAnaHR0cHM6Ly9maGlyLmRrLnN3aXNzdHBoLW1pcy5jaC9tYXRjaGJveC9maGlyL0NvZGVTeXN0ZW0vZW1jYXJlLWN1c3RvbS1jb2RlcycpKSkKCgovLyAqKioqKioqKioqKioqKioqKioqKioqKiogICBIYXNPYnMgKioqKioqKioqKioqKioqKioqKioqKioqLwovKgpkZWZpbmUgZnVuY3Rpb24gSGFzT2JzKGlkbGlzdCBMaXN0PFN5c3RlbS5Db2RlPik6CiAgICBhc3Nlc09ic2VydmF0aW9uKEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyKGlkbGlzdCkpCgpkZWZpbmUgZnVuY3Rpb24gSGFzT2JzKGlkIFN5c3RlbS5Db2RlKToKICAgIGFzc2VzT2JzZXJ2YXRpb24oR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXIoe2lkfSkpCiovCmRlZmluZSBmdW5jdGlvbiBIYXNPYnMoaWQgU3lzdGVtLkNvZGUpOgogICAgYXNzZXNPYnNlcnZhdGlvbihHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlcihpZCkpCgpkZWZpbmUgZnVuY3Rpb24gSGFzT2JzKGlkIFN5c3RlbS5TdHJpbmcsIGNvZGVzeXN0ZW0gU3lzdGVtLlN0cmluZyk6CiAgICBhc3Nlc09ic2VydmF0aW9uKEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyKGNvZGluZyhpZCwgY29kZXN5c3RlbSkpKQoKZGVmaW5lIGZ1bmN0aW9uIEhhc09icyhpZCBTeXN0ZW0uU3RyaW5nKToKICAgIGFzc2VzT2JzZXJ2YXRpb24oR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXIoY29kaW5nKGlkLCAnaHR0cHM6Ly9maGlyLmRrLnN3aXNzdHBoLW1pcy5jaC9tYXRjaGJveC9maGlyL0NvZGVTeXN0ZW0vZW1jYXJlLWN1c3RvbS1jb2RlcycpKSkKCmRlZmluZSBmdW5jdGlvbiBIYXNPYnMoaWQgRkhJUi5jb2RlLCBjb2Rlc3lzdGVtIFN5c3RlbS5TdHJpbmcpOgogICAgYXNzZXNPYnNlcnZhdGlvbihHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlcihjb2RpbmcoaWQsIGNvZGVzeXN0ZW0pKSkKLyoKZGVmaW5lIGZ1bmN0aW9uIEdldEhpc3RvcmljT2JzZXJ2YXRpb24oaWRsaXN0IExpc3Q8U3lzdGVtLkNvZGU+LCBuYmRheXMgSW50ZWdlcik6CiAgaWYgR2V0SGlzdG9yaWNPYnNlcnZhdGlvbk5vdGZvdW5kKGlkbGlzdCAsIGNvZGVzeXN0ZW0gLCBuYmRheXMgKSBpcyBudWxsIHRoZW4gCiAgICAgIEdldEhpc3RvcmljT2JzZXJ2YXRpb25Ob3Rmb3VuZChpZGxpc3QgLCBjb2Rlc3lzdGVtICwgbmJkYXlzICkKICBlbHNlCiAgICBHZXRIaXN0b3JpY09ic2VydmF0aW9uTm90Zm91bmQoaWRsaXN0ICwgY29kZXN5c3RlbSAsIG5iZGF5cyApCiovCgpkZWZpbmUgZnVuY3Rpb24gR2V0SGlzdG9yaWNPYnNlcnZhdGlvbihpZCBTeXN0ZW0uQ29kZSwgbmJkYXlzIEludGVnZXIpOgogIGlmIEdldEhpc3RvcmljT2JzZXJ2YXRpb25Eb25lKGlkICwgIG5iZGF5cyApIGlzIG5vdCBudWxsIHRoZW4gCiAgICAgIEdldEhpc3RvcmljT2JzZXJ2YXRpb25Eb25lKGlkICwgIG5iZGF5cyApCiAgZWxzZQogICAgR2V0SGlzdG9yaWNPYnNlcnZhdGlvbk5vdGZvdW5kKGlkICAsIG5iZGF5cyApCi8qCmRlZmluZSBmdW5jdGlvbiBHZXRIaXN0b3JpY09ic2VydmF0aW9uRG9uZShpZGxpc3QgTGlzdDxTeXN0ZW0uQ29kZT4sIG5iZGF5cyBJbnRlZ2VyKToKICAgICAgTGFzdChbT2JzZXJ2YXRpb246IGlkbGlzdCBdIE8KICAgICAgICB3aGVyZSAgTy5zdGF0dXMgaW4geyAnZmluYWwnLCAnYW1lbmRlZCcsICdjb3JyZWN0ZWQnfQogICAgICAgIGFuZCAoZGlmZmVyZW5jZSBpbiBkYXlzIGJldHdlZW4gTy5pc3N1ZWQgYW5kIFRvZGF5KCkpIDwgbmJkYXlzKQoqLwpkZWZpbmUgZnVuY3Rpb24gR2V0SGlzdG9yaWNPYnNlcnZhdGlvbkRvbmUoaWQgU3lzdGVtLkNvZGUsIG5iZGF5cyBJbnRlZ2VyKToKICAgICAgTGFzdChbT2JzZXJ2YXRpb246IGlkIF0gTwogICAgICAgIHdoZXJlICBPLnN0YXR1cyBpbiB7ICdmaW5hbCcsICdhbWVuZGVkJywgJ2NvcnJlY3RlZCd9CiAgICAgICAgYW5kIChkaWZmZXJlbmNlIGluIGRheXMgYmV0d2VlbiBPLmlzc3VlZCBhbmQgVG9kYXkoKSkgPCBuYmRheXMgICkKCi8qCmRlZmluZSBmdW5jdGlvbiBHZXRIaXN0b3JpY09ic2VydmF0aW9uTm90Zm91bmQoaWRsaXN0IExpc3Q8U3lzdGVtLkNvZGU+LCBuYmRheXMgSW50ZWdlcik6CiAgICAgIExhc3QoW09ic2VydmF0aW9uOiBpZGxpc3RdIE8KICAgICAgICB3aGVyZSAgTy5zdGF0dXMgaW4geydjYW5jZWxsZWQnfQoqLwpkZWZpbmUgZnVuY3Rpb24gR2V0SGlzdG9yaWNPYnNlcnZhdGlvbk5vdGZvdW5kKGlkIFN5c3RlbS5Db2RlLCBuYmRheXMgSW50ZWdlcik6CiAgICAgIExhc3QoW09ic2VydmF0aW9uOiBpZF0gTwogICAgICAgIHdoZXJlICBPLnN0YXR1cyBpbiB7J2NhbmNlbGxlZCd9CiAgICAgICAgICBhbmQgKGRpZmZlcmVuY2UgaW4gZGF5cyBiZXR3ZWVuIE8uaXNzdWVkIGFuZCBUb2RheSgpKSA8IG5iZGF5cykKLy8gKioqKioqKioqKioqKioqKioqKioqKioqICAgSGFzT2JzSGlzdG9yeSAqKioqKioqKioqKioqKioqKioqKioqKiovCgovKgpkZWZpbmUgZnVuY3Rpb24gSGFzT2JzSGlzdG9yeShpZGxpc3QgTGlzdDxTeXN0ZW0uQ29kZT4sICBuYmRheXMgSW50ZWdlcik6CiAgYXNzZXNPYnNlcnZhdGlvbihHZXRIaXN0b3JpY09ic2VydmF0aW9uKGlkbGlzdCwgbmJkYXlzKSkKCgpkZWZpbmUgZnVuY3Rpb24gSGFzT2JzSGlzdG9yeShpZCBTeXN0ZW0uQ29kZSwgY25iZGF5cyBJbnRlZ2VyKToKICBhc3Nlc09ic2VydmF0aW9uKEdldEhpc3RvcmljT2JzZXJ2YXRpb24oe2lkfSwgbmJkYXlzKSkKKi8KZGVmaW5lIGZ1bmN0aW9uIEhhc09ic0hpc3RvcnkoaWQgU3lzdGVtLkNvZGUsIG5iZGF5cyBJbnRlZ2VyKToKICBhc3Nlc09ic2VydmF0aW9uKEdldEhpc3RvcmljT2JzZXJ2YXRpb24oaWQsIG5iZGF5cykpCgpkZWZpbmUgZnVuY3Rpb24gSGFzT2JzSGlzdG9yeShpZCBTeXN0ZW0uU3RyaW5nLCBjb2Rlc3lzdGVtIFN5c3RlbS5TdHJpbmcsIG5iZGF5cyBJbnRlZ2VyKToKICBhc3Nlc09ic2VydmF0aW9uKEdldEhpc3RvcmljT2JzZXJ2YXRpb24oY29kaW5nKGlkLCBjb2Rlc3lzdGVtKSwgbmJkYXlzKSkKCgpkZWZpbmUgZnVuY3Rpb24gSGFzT2JzSGlzdG9yeShpZCBTeXN0ZW0uU3RyaW5nLCBuYmRheXMgSW50ZWdlcik6CiAgYXNzZXNPYnNlcnZhdGlvbihHZXRIaXN0b3JpY09ic2VydmF0aW9uKGNvZGluZyhpZCwgJ2h0dHBzOi8vZmhpci5kay5zd2lzc3RwaC1taXMuY2gvbWF0Y2hib3gvZmhpci9Db2RlU3lzdGVtL2VtY2FyZS1jdXN0b20tY29kZXMnKSwgbmJkYXlzKSkKCmRlZmluZSBmdW5jdGlvbiBjKHMgU3lzdGVtLlN0cmluZyk6CiAgRkhJUi5jb2RlIHsgdmFsdWU6IHMgfQoKCgpkZWZpbmUgZnVuY3Rpb24gY29kaW5nKHMgU3lzdGVtLlN0cmluZywgdXJsIFN5c3RlbS5TdHJpbmcpOgogIFN5c3RlbS5Db2RlIHsKICAgICAgICAgICAgICAgIGNvZGU6ICBzICwKICAgICAgICAgICAgICAgIHN5c3RlbTogIHVybCAKICAgICAgICAgICAgfQoKZGVmaW5lIGZ1bmN0aW9uIGNvZGluZyhzIEZISVIuY29kZSwgdXJsIFN5c3RlbS5TdHJpbmcpOgogIFN5c3RlbS5Db2RlIHsKICAgICAgICAgICAgICAgIGNvZGU6ICBzLnZhbHVlICwKICAgICAgICAgICAgICAgIHN5c3RlbTogIHVybCAKICAgICAgICAgICAgfQoKZGVmaW5lIGZ1bmN0aW9uIGNvZGluZyhzIFN5c3RlbS5TdHJpbmcpOgogIFN5c3RlbS5Db2RlIHsKICAgICAgICAgICAgICAgIGNvZGU6ICBzICwKICAgICAgICAgICAgICAgIHN5c3RlbTogICdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvQ29kZVN5c3RlbS9lbWNhcmUtY3VzdG9tLWNvZGVzJyAKICAgICAgICAgICAgfQoKCmRlZmluZSBmdW5jdGlvbiBUb1VybChzIFN5c3RlbS5TdHJpbmcpOgogIHVybCB7dmFsdWU6c30KCgoKLy8gKioqKioqKioqKioqKioqKioqKioqKioqICAgR2V0Q29uZCAqKioqKioqKioqKioqKioqKioqKioqKiovCi8qCmRlZmluZSBmdW5jdGlvbiBHZXRDb08uZW5jb3VudGVybmRpdGlvbihpZGxpc3QgTGlzdDxTeXN0ZW0uQ29kZT4pOgogICAgICBMYXN0KFtDb25kaXRpb246IGlkbGlzdF0gTwogICAgICAgIHdoZXJlICBJc0luRW5jb3VudGVyKCBPLmVuY291bnRlcikgCiAgICAgICAgYW5kIGV4aXN0cyhPLnZlcmlmaWNhdGlvblN0YXR1cy5jb2RpbmcgQyB3aGVyZSBDLmNvZGUgaW4geyd1bmNvbmZpcm1lZCcsICdwcm92aXNpb25hbCcsICdkaWZmZXJlbnRpYWwnLCAnY29uZmlybWVkJ30gCiAgICAgICAgYW5kIEMuc3lzdGVtID0gJ2h0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vY29uZGl0aW9uLXZlci1zdGF0dXMnKSkKKi8KZGVmaW5lIGZ1bmN0aW9uIEdldENvbmRpdGlvbihpZCBTeXN0ZW0uQ29kZSk6CiAgICAgIExhc3QoW0NvbmRpdGlvbjogaWRdIE8KICAgICAgICB3aGVyZSAgSXNJbkVuY291bnRlcihPLmVuY291bnRlcikgCiAgICAgICAgYW5kIGV4aXN0cyhPLnZlcmlmaWNhdGlvblN0YXR1cy5jb2RpbmcgQyB3aGVyZSBDLmNvZGUgaW4geyd1bmNvbmZpcm1lZCcsICdwcm92aXNpb25hbCcsICdkaWZmZXJlbnRpYWwnLCAnY29uZmlybWVkJ30gCiAgICAgICAgYW5kIEMuc3lzdGVtID0gJ2h0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vY29uZGl0aW9uLXZlci1zdGF0dXMnKSkKCgpkZWZpbmUgZnVuY3Rpb24gYXNzZXNDb25kaXRpb24oTyBDb25kaXRpb24pOgogIGlmIE8gaXMgbnVsbCB0aGVuIAogICAgZmFsc2UKICBlbHNlCiAgICB0cnVlCi8qCmRlZmluZSBmdW5jdGlvbiBHZXRDb25kKGlkbGlzdCBMaXN0PFN5c3RlbS5Db2RlPik6CiAgR2V0Q29uZGl0aW9uKGlkbGlzdCkKCmRlZmluZSBmdW5jdGlvbiBHZXRDb25kKGlkIFN5c3RlbS5Db2RlKToKICBHZXRDb25kaXRpb24oe2lkfSkKKi8KZGVmaW5lIGZ1bmN0aW9uIEdldENvbmQoaWQgU3lzdGVtLkNvZGUpOgogIChHZXRDb25kaXRpb24oaWQpKQoKZGVmaW5lIGZ1bmN0aW9uIEdldENvbmQoaWQgU3lzdGVtLlN0cmluZywgY29kZXN5c3RlbSBTeXN0ZW0uU3RyaW5nKToKICAoR2V0Q29uZGl0aW9uKGNvZGluZyhpZCwgY29kZXN5c3RlbSkpKQoKZGVmaW5lIGZ1bmN0aW9uIEdldENvbmQoaWQgU3lzdGVtLlN0cmluZyk6CiAgKEdldENvbmRpdGlvbihjb2RpbmcoaWQsICdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvQ29kZVN5c3RlbS9lbWNhcmUtY3VzdG9tLWNvZGVzJykpKQoKLy8gKioqKioqKioqKioqKioqKioqKioqKioqICAgSGFzQ29uZCAqKioqKioqKioqKioqKioqKioqKioqKiovCi8qCmRlZmluZSBmdW5jdGlvbiBIYXNDb25kKGlkbGlzdCBMaXN0PFN5c3RlbS5Db2RlPik6CiAgYXNzZXNDb25kaXRpb24oR2V0Q29uZGl0aW9uKGlkbGlzdCkpCgoKMzUxOEdldENvbmRpdGlvbihpZCkpCiovCmRlZmluZSBmdW5jdGlvbiBIYXNDb25kKGlkIFN5c3RlbS5TdHJpbmcsIGNvZGVzeXN0ZW0gU3lzdGVtLlN0cmluZyk6CiAgYXNzZXNDb25kaXRpb24oR2V0Q29uZGl0aW9uKGNvZGluZyhpZCwgY29kZXN5c3RlbSkpKQoKZGVmaW5lIGZ1bmN0aW9uIEhhc0NvbmQoaWQgU3lzdGVtLlN0cmluZyk6CiAgYXNzZXNDb25kaXRpb24oR2V0Q29uZGl0aW9uKGNvZGluZyhpZCwgJ2h0dHBzOi8vZmhpci5kay5zd2lzc3RwaC1taXMuY2gvbWF0Y2hib3gvZmhpci9Db2RlU3lzdGVtL2VtY2FyZS1jdXN0b20tY29kZXMnKSkpCgoKCi8vICoqKioqKioqKioqKioqKioqKioqKioqKiAgIFBhdGllbnRIYXNIaXN0b3J5T2ZDb25kaXRpb24gKioqKioqKioqKioqKioqKioqKioqKioqLwovKgpkZWZpbmUgZnVuY3Rpb24gR2V0SGlzdG9yaWNDb25kaXRpb24oaWRsaXN0IExpc3Q8U3lzdGVtLkNvZGU+LCAgbmJkYXlzIEludGVnZXIpOgogICAgICBMYXN0KFtDb25kaXRpb246IGlkbGlzdF0gTwogICAgICAgIHdoZXJlICAoZGlmZmVyZW5jZSBpbiBkYXlzIGJldHdlZW4gTy5yZWNvcmRlZERhdGUgYW5kIFRvZGF5KCkpIDwgbmJkYXlzCiAgICAgICAgYW5kIGV4aXN0cyhPLnZlcmlmaWNhdGlvblN0YXR1cy5jb2RpbmcgQyB3aGVyZSBDLmNvZGUgaW4geyd1bmNvbmZpcm1lZCcsICdwcm92aXNpb25hbCcsICdkaWZmZXJlbnRpYWwnLCAnY29uZmlybWVkJ30gCiAgICAgICAgYW5kIEMuc3lzdGVtID0gJ2h0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vY29uZGl0aW9uLXZlci1zdGF0dXMnKSkKKi8KCmRlZmluZSBmdW5jdGlvbiBHZXRIaXN0b3JpY0NvbmRpdGlvbihpZCBTeXN0ZW0uQ29kZSwgIG5iZGF5cyBJbnRlZ2VyKToKICAgICAgTGFzdChbQ29uZGl0aW9uOiBpZF0gTwogICAgICAgIHdoZXJlICAoZGlmZmVyZW5jZSBpbiBkYXlzIGJldHdlZW4gTy5yZWNvcmRlZERhdGUgYW5kIFRvZGF5KCkpIDwgbmJkYXlzCiAgICAgICAgYW5kIGV4aXN0cyhPLnZlcmlmaWNhdGlvblN0YXR1cy5jb2RpbmcgQyB3aGVyZSBDLmNvZGUgaW4geyd1bmNvbmZpcm1lZCcsICdwcm92aXNpb25hbCcsICdkaWZmZXJlbnRpYWwnLCAnY29uZmlybWVkJ30gCiAgICAgICAgYW5kIEMuc3lzdGVtID0gJ2h0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vY29uZGl0aW9uLXZlci1zdGF0dXMnKSkKCgoKCi8qCmRlZmluZSBmdW5jdGlvbiBIYXNDb25kSGlzdG9yeShpZGxpc3QgTGlzdDxTeXN0ZW0uQ29kZT4sICBuYmRheXMgSW50ZWdlcik6CiAgYXNzZXNDb25kaXRpb24oR2V0SGlzdG9yaWNDb25kaXRpb24oaWRsaXN0LCAgbmJkYXlzKSkKCgpkZWZpbmUgZnVuY3Rpb24gSGFzQ29uZEhpc3RvcnkoaWQgU3lzdGVtLkNvZGUsICBuYmRheXMgSW50ZWdlcik6CiAgYXNzZXNDb25kaXRpb24oR2V0SGlzdG9yaWNDb25kaXRpb24oe2lkfSwgbmJkYXlzKSkKKi8KZGVmaW5lIGZ1bmN0aW9uIEhhc0NvbmRIaXN0b3J5KGlkIFN5c3RlbS5Db2RlLCBuYmRheXMgSW50ZWdlcik6CiAgYXNzZXNDb25kaXRpb24oR2V0SGlzdG9yaWNDb25kaXRpb24oaWQsICBuYmRheXMpKQoKZGVmaW5lIGZ1bmN0aW9uIEhhc0NvbmRIaXN0b3J5KGlkIFN5c3RlbS5TdHJpbmcsIGNvZGVzeXN0ZW0gU3lzdGVtLlN0cmluZywgbmJkYXlzIEludGVnZXIpOgogIGFzc2VzQ29uZGl0aW9uKEdldEhpc3RvcmljQ29uZGl0aW9uKGNvZGluZyhpZCxjb2Rlc3lzdGVtKSxuYmRheXMpKQoKCmRlZmluZSBmdW5jdGlvbiBIYXNDb25kSGlzdG9yeShpZCBTeXN0ZW0uU3RyaW5nLCBuYmRheXMgSW50ZWdlcik6CiAgYXNzZXNDb25kaXRpb24oR2V0SGlzdG9yaWNDb25kaXRpb24oY29kaW5nKGlkLCdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvQ29kZVN5c3RlbS9lbWNhcmUtY3VzdG9tLWNvZGVzJyksICBuYmRheXMpKQoKCgovL2RlZmluZSBmdW5jdGlvbiBQYXRpZW50SGFzQ29uZGl0aW9uRHVyaW5nRW5jb3VudGVyKGlkIFN0cmluZywgY29kZXN5c3RlbSB1cmwsIGR1cmF0aW9uIEludGVnZXIpKToKCi8vZGVmaW5lIGZ1bmN0aW9uIFBhdGllbnRIYXNDb25kaXRpb25Gcm9tVmFsdWVTZXREdXJpbmdFbmNvdW50ZXIoaWQgU3RyaW5nLCBjb2Rlc3lzdGVtIHVybCwgZHVyYXRpb24gSW50ZWdlcikpOgoKLy9kZWZpbmUgZnVuY3Rpb24gUGF0aWVudEhhc0hzaXN0b3J5Q29uZGl0aW9uKGlkIFN0cmluZyxjb2Rlc3lzdGVtIHVybCAsIGR1cmF0aW9uIEludGVnZXIpOgovL2RlZmluZSBmdW5jdGlvbiBQYXRpZW50SGFzSHNpc3RvcnlDb25kaXRpb25Gcm9tVmFsdWVTZXQoaWQgU3RyaW5nLGNvZGVzeXN0ZW0gdXJsICwgZHVyYXRpb24gSW50ZWdlcik6CgoKLy8gUGF0aWVudEhhc1N5bXB0b20oInN5bXB0b20gbmFtZSIpOiBzeW1wdG9tIGluIHRoZSBlbmNvdW50ZXIKCgovLyBQYXRpZW50TGFzdE1lYXN1cmVPZigibWVhc3VyZSBuYW1lIik6IG1lYXN1cmUgaW4gdGhlIGVuY291bnRlcgoKLy8gUGF0aWVudExhc3RIaXN0b3JpY01lYXN1cmVPZigibWVhc3VyZSBuYW1lIiwgZHVyYXRpb24pOiBtZWFzdXJlIGluIHRoZSBwYXRpZW50IGhpc3RvcnkgZHVyaW5nIGR1cmF0aW9uCgovLyBQYXRpZW50SGFzRGlhZ25vc3RpYygiRGlhZ25vc3RpYyBuYW1lIiApOiBEaWFnbm9zdGljIGluIHRoZSBlbmNvdW50ZXIKCi8vIFBhdGllbnRIYXNIaXN0b3J5T2ZEaWFnbm9zdGljKCJEaWFnbm9zdGljIG5hbWUiLCBkdXJhdGlvbiApOiBEaWFnbm9zdGljIGluIHRoZSBwYXRpZW50IGhpc3RvcnkgZHVyaW5nIGR1cmF0aW9uCgovLyBQYXRpZW50SGFzUHJvcG9zZWRvckNvbmZpcm1lZERpYW5vc3RpYygiRGlhZ25vc3RpYyBuYW1lIiApOiBEaWFnbm9zdGljIGluIHRoZSBlbmNvdW50ZXIKCi8vIFBhdGllbnRIYXNIaXN0b3J5T2ZQcm9wb3NlZG9yQ29uZmlybWVkRGlhbm9zdGljKCJEaWFnbm9zdGljIG5hbWUiLCBkdXJhdGlvbiApOiBEaWFnbm9zdGljIGluIHRoZSBwYXRpZW50IGhpc3RvcnkgZHVyaW5nIGR1cmF0aW9uCgovLyBQYXRpZW50WlNjb3JlV2ZBKHdpZWdodCwgYWdlKQoKLy8gUGF0aWVudFdlaWdodEZyb21XZkEoYWdlLCBNdWFjKQo="
        }
    ]
}