{
    "resourceType": "Library",
    "id": "EmCareBase",
    "url": "https://fhir.dk.swisstph-mis.ch/matchbox/fhir/Library/EmCareBase",
    "version": "0.99.99",
    "name": "EmCareBase",
    "title": "EmCareBase",
    "status": "active",
    "type": {
        "coding": [
            {
                "system": "http://hl7.org/fhir/ValueSet/library-type",
                "code": "logic-library"
            }
        ]
    },
    "relatedArtifact": [
        {
            "type": "depends-on",
            "resource": "http://fhir.org/guides/who/anc-cds/Library/FHIRHelpers"
        }
    ],
    "dataRequirement": [
        {
            "type": "Patient",
            "profile": [
                "http://hl7.org/fhir/StructureDefinition/Patient"
            ]
        },
        {
            "type": "Observation",
            "profile": [
                "http://hl7.org/fhir/StructureDefinition/Observation"
            ]
        },
        {
            "type": "Encounter",
            "profile": [
                "http://hl7.org/fhir/StructureDefinition/Encounter"
            ]
        }
    ],
    "content": [
        {
            "id": "ig-loader-EmCareBase.cql",
            "contentType": "text/cql",
            "data": "LyoKQGF1dGhvcjogUGF0cmljayBEZWxjcm9peApAZGVzY3JpcHRpb246IFRoaXMgbGlicmFyeSBpcyBwYXJ0IG9mIHRoZSBwcm9qZWN0IEVtQ2FyZSBQcm9qZWN0LCBpdHMgYWxsb3dzIHN0YW5kYXJkaXNhdGlvbiBmb3IgdGhlIG9ic2VydmF0aW9uIHByb2Nlc3NpbmcKKi8KCmxpYnJhcnkgRW1DYXJlQmFzZSB2ZXJzaW9uICcwLjk5Ljk5JwoKdXNpbmcgRkhJUiB2ZXJzaW9uICc0LjAuMScKCmluY2x1ZGUgRkhJUkhlbHBlcnMgdmVyc2lvbiAnNC4wLjEnCgoKY29udGV4dCBFbmNvdW50ZXIKCi8vICoqKioqKioqKioqKioqKioqKioqKiAgIFBhdGllbnRIYXNPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlciAqKioqKioqKioqKioqKioqKioqKiovCi8vIG9icyBhbmQgdmFsdWUgOiByZXR1cm4gdmFsdWUKLy8gb2JzIGFuZCBubyB2YWx1ZTogcmV0dXJuIHRydWUKLy8gb2JzIGNhbmNlbGxlZCAobm90IGZvdW5kKSA6IHJldHVybiBmYWxzZQovLyBvYnMgbm90IGZvdW5kIDogcmV0dXJuIG51bGwKCmRlZmluZSAiWWVzIjoKICB0cnVlCgpkZWZpbmUgIk5vIjoKICBmYWxzZSAKCmRlZmluZSBmdW5jdGlvbiBnZXRWYWx1ZShPIE9ic2VydmF0aW9uKToKICBjYXNlICAKICAgICAgd2hlbiAgTyBpcyBudWxsIHRoZW4gbnVsbAogICAgICBlbHNlIE8udmFsdWUKICBlbmQKCgpkZWZpbmUgZnVuY3Rpb24gYXNzZXNPYnNlcnZhdGlvbihPIE9ic2VydmF0aW9uKToKICBjYXNlICAKICAgICAgd2hlbiAgTyA9IG51bGwgdGhlbiBudWxsCiAgICAgIHdoZW4gIE8uc3RhdHVzIGluICB7J2NhbmNlbGxlZCd9IHRoZW4gZmFsc2UKICAgICAgd2hlbiBPLnZhbHVlIGlzIG51bGwgdGhlbiAgdHJ1ZQoKICAgICAgZWxzZSBPLnZhbHVlCiAgZW5kCi8qICAgICAgCmRlZmluZSBmdW5jdGlvbiBHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlcihpZGxpc3QgTGlzdDxTeXN0ZW0uQ29kZT4pOgogIGlmIEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyRG9uZShpZGxpc3QgKSBpcyBudWxsIHRoZW4gCiAgICAgIEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyRG9uZShpZGxpc3QgKQogIGVsc2UKICAgIEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyTm90Rm91bmQoaWRsaXN0ICkKKi8KZGVmaW5lIGZ1bmN0aW9uIEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyKGlkIFN5c3RlbS5Db2RlKToKICBpZiBHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlckRvbmUoaWQgKSBpcyBudWxsIHRoZW4gCiAgICAgIEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyRG9uZShpZCApCiAgZWxzZQogICAgR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXJOb3RGb3VuZChpZCApCi8qCmRlZmluZSBmdW5jdGlvbiBHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlckRvbmUoaWRsaXN0IExpc3Q8U3lzdGVtLkNvZGU+KToKICAgICAgTGFzdChbT2JzZXJ2YXRpb246IGlkbGlzdCBdIE8KICAgICAgICB3aGVyZSAgTy5lbmNvdW50ZXIuaWQgPSBFbmNvdW50ZXIuaWQKICAgICAgICBhbmQgTy5zdGF0dXMgaW4geyAnZmluYWwnLCAnYW1lbmRlZCcsICdjb3JyZWN0ZWQnfSkKKi8KZGVmaW5lIGZ1bmN0aW9uIEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyRG9uZShpZCBTeXN0ZW0uQ29kZSk6CiAgICAgIExhc3QoW09ic2VydmF0aW9uOiBpZCBdIE8KICAgICAgICB3aGVyZSAgTy5lbmNvdW50ZXIuaWQgPSBFbmNvdW50ZXIuaWQKICAgICAgICBhbmQgTy5zdGF0dXMgaW4geyAnZmluYWwnLCAnYW1lbmRlZCcsICdjb3JyZWN0ZWQnfSkKCi8qCmRlZmluZSBmdW5jdGlvbiBHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlck5vdEZvdW5kKGlkbGlzdCBMaXN0PFN5c3RlbS5Db2RlPik6CiAgICAgIExhc3QoW09ic2VydmF0aW9uOiBpZGxpc3RdIE8KICAgICAgIHdoZXJlIE8uZW5jb3VudGVyLmlkID0gRW5jb3VudGVyLmlkCiAgICAgICAgICBhbmQgTy5zdGF0dXMgaW4geydjYW5jZWxsZWQnfSkKICAgICAgICAgICovCmRlZmluZSBmdW5jdGlvbiBHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlck5vdEZvdW5kKGlkIFN5c3RlbS5Db2RlKToKICAgICAgTGFzdChbT2JzZXJ2YXRpb246IGlkXSBPCiAgICAgICB3aGVyZSBPLmVuY291bnRlci5pZCA9IEVuY291bnRlci5pZAogICAgICAgICAgYW5kIE8uc3RhdHVzIGluIHsnY2FuY2VsbGVkJ30pCi8qCgpkZWZpbmUgZnVuY3Rpb24gR2V0TnVtYmVyT2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXIoaWRsaXN0IExpc3Q8U3lzdGVtLkNvZGU+KToKICBDb3VudCgKICAgIFtPYnNlcnZhdGlvbjogaWRsaXN0XSBPCiAgICAgICAgd2hlcmUgTy5lbmNvdW50ZXIuaWQgPSBFbmNvdW50ZXIuaWQKICAgICAgICBhbmQgTy5zdGF0dXMgaW4geyAnZmluYWwnLCAnYW1lbmRlZCcsICdjb3JyZWN0ZWQnfSkKKi8KZGVmaW5lIGZ1bmN0aW9uIEdldE51bWJlck9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyKGlkIFN5c3RlbS5Db2RlKToKICBDb3VudCgKICAgIFtPYnNlcnZhdGlvbjogaWRdIE8KICAgICAgICB3aGVyZSBPLmVuY291bnRlci5pZCA9IEVuY291bnRlci5pZAogICAgICAgIGFuZCBPLnN0YXR1cyBpbiB7ICdmaW5hbCcsICdhbWVuZGVkJywgJ2NvcnJlY3RlZCd9KQoKLy8gKioqKioqKioqKioqKioqKioqKioqKioqICAgR2V0T2JzVmFsdWUgKioqKioqKioqKioqKioqKioqKioqKioqLwovKgpkZWZpbmUgZnVuY3Rpb24gR2V0T2JzVmFsdWUoaWRsaXN0IExpc3Q8U3lzdGVtLkNvZGU+KToKICAgIGdldFZhbHVlKEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyKGlkbGlzdCkpCgpkZWZpbmUgZnVuY3Rpb24gR2V0T2JzVmFsdWUoaWQgU3lzdGVtLkNvZGUpOgogICAgZ2V0VmFsdWUoR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXIoe2lkfSkpCiovCgpkZWZpbmUgZnVuY3Rpb24gR2V0T2JzVmFsdWUoaWQgU3lzdGVtLkNvZGUpOgogICAgZ2V0VmFsdWUoR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXIoaWQpKQoKZGVmaW5lIGZ1bmN0aW9uIEdldE9ic1ZhbHVlKGlkIFN5c3RlbS5TdHJpbmcsIGNvZGVzeXN0ZW0gU3lzdGVtLlN0cmluZyk6CiAgICBnZXRWYWx1ZShHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlcihjb2RpbmcoaWQsIGNvZGVzeXN0ZW0pKSkKCmRlZmluZSBmdW5jdGlvbiBHZXRPYnNWYWx1ZShpZCBTeXN0ZW0uU3RyaW5nKToKICAgIGdldFZhbHVlKEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyKGNvZGluZyhpZCwgJ2h0dHBzOi8vZmhpci5kay5zd2lzc3RwaC1taXMuY2gvbWF0Y2hib3gvZmhpci9Db2RlU3lzdGVtL2VtY2FyZS1jdXN0b20tY29kZXMnKSkpCgoKLy8gKioqKioqKioqKioqKioqKioqKioqKioqICAgSGFzT2JzICoqKioqKioqKioqKioqKioqKioqKioqKi8KLyoKZGVmaW5lIGZ1bmN0aW9uIEhhc09icyhpZGxpc3QgTGlzdDxTeXN0ZW0uQ29kZT4pOgogICAgYXNzZXNPYnNlcnZhdGlvbihHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlcihpZGxpc3QpKQoKZGVmaW5lIGZ1bmN0aW9uIEhhc09icyhpZCBTeXN0ZW0uQ29kZSk6CiAgICBhc3Nlc09ic2VydmF0aW9uKEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyKHtpZH0pKQoqLwpkZWZpbmUgZnVuY3Rpb24gSGFzT2JzKGlkIFN5c3RlbS5Db2RlKToKICAgIGFzc2VzT2JzZXJ2YXRpb24oR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXIoaWQpKQoKZGVmaW5lIGZ1bmN0aW9uIEhhc09icyhpZCBTeXN0ZW0uU3RyaW5nLCBjb2Rlc3lzdGVtIFN5c3RlbS5TdHJpbmcpOgogICAgYXNzZXNPYnNlcnZhdGlvbihHZXRPYnNlcnZhdGlvbkR1cmluZ0VuY291bnRlcihjb2RpbmcoaWQsIGNvZGVzeXN0ZW0pKSkKCmRlZmluZSBmdW5jdGlvbiBIYXNPYnMoaWQgU3lzdGVtLlN0cmluZyk6CiAgICBhc3Nlc09ic2VydmF0aW9uKEdldE9ic2VydmF0aW9uRHVyaW5nRW5jb3VudGVyKGNvZGluZyhpZCwgJ2h0dHBzOi8vZmhpci5kay5zd2lzc3RwaC1taXMuY2gvbWF0Y2hib3gvZmhpci9Db2RlU3lzdGVtL2VtY2FyZS1jdXN0b20tY29kZXMnKSkpCgpkZWZpbmUgZnVuY3Rpb24gSGFzT2JzKGlkIEZISVIuY29kZSwgY29kZXN5c3RlbSBTeXN0ZW0uU3RyaW5nKToKICAgIGFzc2VzT2JzZXJ2YXRpb24oR2V0T2JzZXJ2YXRpb25EdXJpbmdFbmNvdW50ZXIoY29kaW5nKGlkLCBjb2Rlc3lzdGVtKSkpCi8qCmRlZmluZSBmdW5jdGlvbiBHZXRIaXN0b3JpY09ic2VydmF0aW9uKGlkbGlzdCBMaXN0PFN5c3RlbS5Db2RlPiwgbmJkYXlzIEludGVnZXIpOgogIGlmIEdldEhpc3RvcmljT2JzZXJ2YXRpb25Ob3Rmb3VuZChpZGxpc3QgLCBjb2Rlc3lzdGVtICwgbmJkYXlzICkgaXMgbnVsbCB0aGVuIAogICAgICBHZXRIaXN0b3JpY09ic2VydmF0aW9uTm90Zm91bmQoaWRsaXN0ICwgY29kZXN5c3RlbSAsIG5iZGF5cyApCiAgZWxzZQogICAgR2V0SGlzdG9yaWNPYnNlcnZhdGlvbk5vdGZvdW5kKGlkbGlzdCAsIGNvZGVzeXN0ZW0gLCBuYmRheXMgKQoqLwpkZWZpbmUgZnVuY3Rpb24gR2V0SGlzdG9yaWNPYnNlcnZhdGlvbihpZCBTeXN0ZW0uQ29kZSwgbmJkYXlzIEludGVnZXIpOgogIGlmIEdldEhpc3RvcmljT2JzZXJ2YXRpb25Ob3Rmb3VuZChpZCAsICBuYmRheXMgKSBpcyBudWxsIHRoZW4gCiAgICAgIEdldEhpc3RvcmljT2JzZXJ2YXRpb25Ob3Rmb3VuZChpZCAsICBuYmRheXMgKQogIGVsc2UKICAgIEdldEhpc3RvcmljT2JzZXJ2YXRpb25Ob3Rmb3VuZChpZCAgLCBuYmRheXMgKQovKgpkZWZpbmUgZnVuY3Rpb24gR2V0SGlzdG9yaWNPYnNlcnZhdGlvbkRvbmUoaWRsaXN0IExpc3Q8U3lzdGVtLkNvZGU+LCBuYmRheXMgSW50ZWdlcik6CiAgICAgIExhc3QoW09ic2VydmF0aW9uOiBpZGxpc3QgXSBPCiAgICAgICAgd2hlcmUgIE8uc3RhdHVzIGluIHsgJ2ZpbmFsJywgJ2FtZW5kZWQnLCAnY29ycmVjdGVkJ30KICAgICAgICBhbmQgZGlmZmVyZW5jZSBpbiBkYXlzIGJldHdlZW4gTy5pc3N1ZWQgYW5kIFRvZGF5KCkgPCBuYmRheXMpCiovCmRlZmluZSBmdW5jdGlvbiBHZXRIaXN0b3JpY09ic2VydmF0aW9uRG9uZShpZCBTeXN0ZW0uQ29kZSwgbmJkYXlzIEludGVnZXIpOgogICAgICBMYXN0KFtPYnNlcnZhdGlvbjogaWQgXSBPCiAgICAgICAgd2hlcmUgIE8uc3RhdHVzIGluIHsgJ2ZpbmFsJywgJ2FtZW5kZWQnLCAnY29ycmVjdGVkJ30KICAgICAgICBhbmQgZGlmZmVyZW5jZSBpbiBkYXlzIGJldHdlZW4gTy5pc3N1ZWQgYW5kIFRvZGF5KCkgPCBuYmRheXMpCgovKgpkZWZpbmUgZnVuY3Rpb24gR2V0SGlzdG9yaWNPYnNlcnZhdGlvbk5vdGZvdW5kKGlkbGlzdCBMaXN0PFN5c3RlbS5Db2RlPiwgbmJkYXlzIEludGVnZXIpOgogICAgICBMYXN0KFtPYnNlcnZhdGlvbjogaWRsaXN0XSBPCiAgICAgICAgd2hlcmUgIE8uc3RhdHVzIGluIHsnY2FuY2VsbGVkJ30KICAgICAgICAgIGFuZCBkaWZmZXJlbmNlIGluIGRheXMgYmV0d2VlbiBPLmlzc3VlZCBhbmQgVG9kYXkoKSA8IG5iZGF5cykKKi8gCgpkZWZpbmUgZnVuY3Rpb24gR2V0SGlzdG9yaWNPYnNlcnZhdGlvbk5vdGZvdW5kKGlkIFN5c3RlbS5Db2RlLCBuYmRheXMgSW50ZWdlcik6CiAgICAgIExhc3QoW09ic2VydmF0aW9uOiBpZF0gTwogICAgICAgIHdoZXJlICBPLnN0YXR1cyBpbiB7J2NhbmNlbGxlZCd9CiAgICAgICAgICBhbmQgZGlmZmVyZW5jZSBpbiBkYXlzIGJldHdlZW4gTy5pc3N1ZWQgYW5kIFRvZGF5KCkgPCBuYmRheXMpCi8vICoqKioqKioqKioqKioqKioqKioqKioqKiAgIEhhc09ic0hpc3RvcnkgKioqKioqKioqKioqKioqKioqKioqKioqLwoKLyoKZGVmaW5lIGZ1bmN0aW9uIEhhc09ic0hpc3RvcnkoaWRsaXN0IExpc3Q8U3lzdGVtLkNvZGU+LCAgbmJkYXlzIEludGVnZXIpOgogIGFzc2VzT2JzZXJ2YXRpb24oR2V0SGlzdG9yaWNPYnNlcnZhdGlvbihpZGxpc3QsIG5iZGF5cykpCgoKZGVmaW5lIGZ1bmN0aW9uIEhhc09ic0hpc3RvcnkoaWQgU3lzdGVtLkNvZGUsIGNuYmRheXMgSW50ZWdlcik6CiAgYXNzZXNPYnNlcnZhdGlvbihHZXRIaXN0b3JpY09ic2VydmF0aW9uKHtpZH0sIG5iZGF5cykpCiovCmRlZmluZSBmdW5jdGlvbiBIYXNPYnNIaXN0b3J5KGlkIFN5c3RlbS5Db2RlLCBuYmRheXMgSW50ZWdlcik6CiAgYXNzZXNPYnNlcnZhdGlvbihHZXRIaXN0b3JpY09ic2VydmF0aW9uKGlkLCBuYmRheXMpKQoKZGVmaW5lIGZ1bmN0aW9uIEhhc09ic0hpc3RvcnkoaWQgU3lzdGVtLlN0cmluZywgY29kZXN5c3RlbSBTeXN0ZW0uU3RyaW5nLCBuYmRheXMgSW50ZWdlcik6CiAgYXNzZXNPYnNlcnZhdGlvbihHZXRIaXN0b3JpY09ic2VydmF0aW9uKGNvZGluZyhpZCwgY29kZXN5c3RlbSksIG5iZGF5cykpCgoKZGVmaW5lIGZ1bmN0aW9uIEhhc09ic0hpc3RvcnkoaWQgU3lzdGVtLlN0cmluZywgbmJkYXlzIEludGVnZXIpOgogIGFzc2VzT2JzZXJ2YXRpb24oR2V0SGlzdG9yaWNPYnNlcnZhdGlvbihjb2RpbmcoaWQsICdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvQ29kZVN5c3RlbS9lbWNhcmUtY3VzdG9tLWNvZGVzJyksIG5iZGF5cykpCgpkZWZpbmUgZnVuY3Rpb24gYyhzIFN5c3RlbS5TdHJpbmcpOgogIEZISVIuY29kZSB7IHZhbHVlOiBzIH0KCgoKZGVmaW5lIGZ1bmN0aW9uIGNvZGluZyhzIFN5c3RlbS5TdHJpbmcsIHVybCBTeXN0ZW0uU3RyaW5nKToKICBTeXN0ZW0uQ29kZSB7CiAgICAgICAgICAgICAgICBjb2RlOiAgcyAsCiAgICAgICAgICAgICAgICBzeXN0ZW06ICB1cmwgLAogICAgICAgICAgICB9CgpkZWZpbmUgZnVuY3Rpb24gY29kaW5nKHMgRkhJUi5jb2RlLCB1cmwgU3lzdGVtLlN0cmluZyk6CiAgU3lzdGVtLkNvZGUgewogICAgICAgICAgICAgICAgY29kZTogIHMudmFsdWUgLAogICAgICAgICAgICAgICAgc3lzdGVtOiAgdXJsICwKICAgICAgICAgICAgfQoKZGVmaW5lIGZ1bmN0aW9uIGNvZGluZyhzIFN5c3RlbS5TdHJpbmcpOgogIGNvZGluZyhzICwgJ2h0dHBzOi8vZmhpci5kay5zd2lzc3RwaC1taXMuY2gvbWF0Y2hib3gvZmhpci9Db2RlU3lzdGVtL2VtY2FyZS1jdXN0b20tY29kZXMnKQoKZGVmaW5lIGZ1bmN0aW9uIFRvVXJsKHMgU3lzdGVtLlN0cmluZyk6CiAgdXJsIHt2YWx1ZTpzfQoKLy8gKioqKioqKioqKioqKioqKioqKioqKioqICAgR2V0Q29uZCAqKioqKioqKioqKioqKioqKioqKioqKiovCi8qCmRlZmluZSBmdW5jdGlvbiBHZXRDb25kaXRpb24oaWRsaXN0IExpc3Q8U3lzdGVtLkNvZGU+KToKICAgICAgTGFzdChbQ29uZGl0aW9uOiBpZGxpc3RdIE8KICAgICAgICB3aGVyZSBPLmVuY291bnRlci5pZCA9IEVuY291bnRlci5pZAogICAgICAgIGFuZCBleGlzdHMoTy52ZXJpZmljYXRpb25TdGF0dXMuY29kaW5nIEMgd2hlcmUgQy5jb2RlIGluIHsndW5jb25maXJtZWQnLCAncHJvdmlzaW9uYWwnLCAnZGlmZmVyZW50aWFsJywgJ2NvbmZpcm1lZCd9IAogICAgICAgIGFuZCBDLnN5c3RlbSA9ICdodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL2NvbmRpdGlvbi12ZXItc3RhdHVzJykpCiovCmRlZmluZSBmdW5jdGlvbiBHZXRDb25kaXRpb24oaWQgU3lzdGVtLkNvZGUpOgogICAgICBMYXN0KFtDb25kaXRpb246IGlkXSBPCiAgICAgICAgd2hlcmUgTy5lbmNvdW50ZXIuaWQgPSBFbmNvdW50ZXIuaWQKICAgICAgICBhbmQgZXhpc3RzKE8udmVyaWZpY2F0aW9uU3RhdHVzLmNvZGluZyBDIHdoZXJlIEMuY29kZSBpbiB7J3VuY29uZmlybWVkJywgJ3Byb3Zpc2lvbmFsJywgJ2RpZmZlcmVudGlhbCcsICdjb25maXJtZWQnfSAKICAgICAgICBhbmQgQy5zeXN0ZW0gPSAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9jb25kaXRpb24tdmVyLXN0YXR1cycpKQoKCmRlZmluZSBmdW5jdGlvbiBhc3Nlc0NvbmRpdGlvbihPIENvbmRpdGlvbik6CiAgaWYgTyBpcyBudWxsIHRoZW4gCiAgICBmYWxzZQogIGVsc2UKICAgIHRydWUKLyoKZGVmaW5lIGZ1bmN0aW9uIEdldENvbmQoaWRsaXN0IExpc3Q8U3lzdGVtLkNvZGU+KToKICBHZXRDb25kaXRpb24oaWRsaXN0KQoKZGVmaW5lIGZ1bmN0aW9uIEdldENvbmQoaWQgU3lzdGVtLkNvZGUpOgogIEdldENvbmRpdGlvbih7aWR9KQoqLwpkZWZpbmUgZnVuY3Rpb24gR2V0Q29uZChpZCBTeXN0ZW0uQ29kZSk6CiAgKEdldENvbmRpdGlvbihpZCkpCgpkZWZpbmUgZnVuY3Rpb24gR2V0Q29uZChpZCBTeXN0ZW0uU3RyaW5nLCBjb2Rlc3lzdGVtIFN5c3RlbS5TdHJpbmcpOgogIChHZXRDb25kaXRpb24oY29kaW5nKGlkLCBjb2Rlc3lzdGVtKSkpCgpkZWZpbmUgZnVuY3Rpb24gR2V0Q29uZChpZCBTeXN0ZW0uU3RyaW5nKToKICAoR2V0Q29uZGl0aW9uKGNvZGluZyhpZCwgJ2h0dHBzOi8vZmhpci5kay5zd2lzc3RwaC1taXMuY2gvbWF0Y2hib3gvZmhpci9Db2RlU3lzdGVtL2VtY2FyZS1jdXN0b20tY29kZXMnKSkpCgovLyAqKioqKioqKioqKioqKioqKioqKioqKiogICBIYXNDb25kICoqKioqKioqKioqKioqKioqKioqKioqKi8KLyoKZGVmaW5lIGZ1bmN0aW9uIEhhc0NvbmQoaWRsaXN0IExpc3Q8U3lzdGVtLkNvZGU+KToKICBhc3Nlc0NvbmRpdGlvbihHZXRDb25kaXRpb24oaWRsaXN0KSkKCmRlZmluZSBmdW5jdGlvbiBIYXNDb25kKGlkIFN5c3RlbS5Db2RlKToKICBhc3Nlc0NvbmRpdGlvbihHZXRDb25kaXRpb24oe2lkfSkpCiovCgoKZGVmaW5lIGZ1bmN0aW9uIEhhc0NvbmQoaWQgU3lzdGVtLkNvZGUpOgogIGFzc2VzQ29uZGl0aW9uKEdldENvbmRpdGlvbihpZCkpCgpkZWZpbmUgZnVuY3Rpb24gSGFzQ29uZChpZCBTeXN0ZW0uU3RyaW5nLCBjb2Rlc3lzdGVtIFN5c3RlbS5TdHJpbmcpOgogIGFzc2VzQ29uZGl0aW9uKEdldENvbmRpdGlvbihjb2RpbmcoaWQsIGNvZGVzeXN0ZW0pKSkKCmRlZmluZSBmdW5jdGlvbiBIYXNDb25kKGlkIFN5c3RlbS5TdHJpbmcpOgogIGFzc2VzQ29uZGl0aW9uKEdldENvbmRpdGlvbihjb2RpbmcoaWQsICdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvQ29kZVN5c3RlbS9lbWNhcmUtY3VzdG9tLWNvZGVzJykpKQoKCgovLyAqKioqKioqKioqKioqKioqKioqKioqKiogICBQYXRpZW50SGFzSGlzdG9yeU9mQ29uZGl0aW9uICoqKioqKioqKioqKioqKioqKioqKioqKi8KLyoKZGVmaW5lIGZ1bmN0aW9uIEdldEhpc3RvcmljQ29uZGl0aW9uKGlkbGlzdCBMaXN0PFN5c3RlbS5Db2RlPiwgIG5iZGF5cyBJbnRlZ2VyKToKICAgICAgTGFzdChbQ29uZGl0aW9uOiBpZGxpc3RdIE8KICAgICAgICB3aGVyZSAgZGlmZmVyZW5jZSBpbiBkYXlzIGJldHdlZW4gTy5yZWNvcmRlZERhdGUgYW5kIFRvZGF5KCkgPCBuYmRheXMKICAgICAgICBhbmQgZXhpc3RzKE8udmVyaWZpY2F0aW9uU3RhdHVzLmNvZGluZyBDIHdoZXJlIEMuY29kZSBpbiB7J3VuY29uZmlybWVkJywgJ3Byb3Zpc2lvbmFsJywgJ2RpZmZlcmVudGlhbCcsICdjb25maXJtZWQnfSAKICAgICAgICBhbmQgQy5zeXN0ZW0gPSAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9jb25kaXRpb24tdmVyLXN0YXR1cycpKQoqLwoKZGVmaW5lIGZ1bmN0aW9uIEdldEhpc3RvcmljQ29uZGl0aW9uKGlkIFN5c3RlbS5Db2RlLCAgbmJkYXlzIEludGVnZXIpOgogICAgICBMYXN0KFtDb25kaXRpb246IGlkXSBPCiAgICAgICAgd2hlcmUgIGRpZmZlcmVuY2UgaW4gZGF5cyBiZXR3ZWVuIE8ucmVjb3JkZWREYXRlIGFuZCBUb2RheSgpIDwgbmJkYXlzCiAgICAgICAgYW5kIGV4aXN0cyhPLnZlcmlmaWNhdGlvblN0YXR1cy5jb2RpbmcgQyB3aGVyZSBDLmNvZGUgaW4geyd1bmNvbmZpcm1lZCcsICdwcm92aXNpb25hbCcsICdkaWZmZXJlbnRpYWwnLCAnY29uZmlybWVkJ30gCiAgICAgICAgYW5kIEMuc3lzdGVtID0gJ2h0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vY29uZGl0aW9uLXZlci1zdGF0dXMnKSkKCgoKCi8qCmRlZmluZSBmdW5jdGlvbiBIYXNDb25kSGlzdG9yeShpZGxpc3QgTGlzdDxTeXN0ZW0uQ29kZT4sICBuYmRheXMgSW50ZWdlcik6CiAgYXNzZXNDb25kaXRpb24oR2V0SGlzdG9yaWNDb25kaXRpb24oaWRsaXN0LCAgbmJkYXlzKSkKCgpkZWZpbmUgZnVuY3Rpb24gSGFzQ29uZEhpc3RvcnkoaWQgU3lzdGVtLkNvZGUsICBuYmRheXMgSW50ZWdlcik6CiAgYXNzZXNDb25kaXRpb24oR2V0SGlzdG9yaWNDb25kaXRpb24oe2lkfSwgbmJkYXlzKSkKKi8KZGVmaW5lIGZ1bmN0aW9uIEhhc0NvbmRIaXN0b3J5KGlkIFN5c3RlbS5Db2RlLCBuYmRheXMgSW50ZWdlcik6CiAgYXNzZXNDb25kaXRpb24oR2V0SGlzdG9yaWNDb25kaXRpb24oaWQsICBuYmRheXMpKQoKZGVmaW5lIGZ1bmN0aW9uIEhhc0NvbmRIaXN0b3J5KGlkIFN5c3RlbS5TdHJpbmcsIGNvZGVzeXN0ZW0gU3lzdGVtLlN0cmluZywgbmJkYXlzIEludGVnZXIpOgogIGFzc2VzQ29uZGl0aW9uKEdldEhpc3RvcmljQ29uZGl0aW9uKGNvZGluZyhpZCxjb2Rlc3lzdGVtKSxuYmRheXMpKQoKCmRlZmluZSBmdW5jdGlvbiBIYXNDb25kSGlzdG9yeShpZCBTeXN0ZW0uU3RyaW5nLCBuYmRheXMgSW50ZWdlcik6CiAgYXNzZXNDb25kaXRpb24oR2V0SGlzdG9yaWNDb25kaXRpb24oY29kaW5nKGlkLCdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvQ29kZVN5c3RlbS9lbWNhcmUtY3VzdG9tLWNvZGVzJyksICBuYmRheXMpKQoKCgovL2RlZmluZSBmdW5jdGlvbiBQYXRpZW50SGFzQ29uZGl0aW9uRHVyaW5nRW5jb3VudGVyKGlkIFN0cmluZywgY29kZXN5c3RlbSB1cmwsIGR1cmF0aW9uIEludGVnZXIpKToKCi8vZGVmaW5lIGZ1bmN0aW9uIFBhdGllbnRIYXNDb25kaXRpb25Gcm9tVmFsdWVTZXREdXJpbmdFbmNvdW50ZXIoaWQgU3RyaW5nLCBjb2Rlc3lzdGVtIHVybCwgZHVyYXRpb24gSW50ZWdlcikpOgoKLy9kZWZpbmUgZnVuY3Rpb24gUGF0aWVudEhhc0hzaXN0b3J5Q29uZGl0aW9uKGlkIFN0cmluZyxjb2Rlc3lzdGVtIHVybCAsIGR1cmF0aW9uIEludGVnZXIpOgovL2RlZmluZSBmdW5jdGlvbiBQYXRpZW50SGFzSHNpc3RvcnlDb25kaXRpb25Gcm9tVmFsdWVTZXQoaWQgU3RyaW5nLGNvZGVzeXN0ZW0gdXJsICwgZHVyYXRpb24gSW50ZWdlcik6CgoKLy8gUGF0aWVudEhhc1N5bXB0b20oInN5bXB0b20gbmFtZSIpOiBzeW1wdG9tIGluIHRoZSBlbmNvdW50ZXIKCgovLyBQYXRpZW50TGFzdE1lYXN1cmVPZigibWVhc3VyZSBuYW1lIik6IG1lYXN1cmUgaW4gdGhlIGVuY291bnRlcgoKLy8gUGF0aWVudExhc3RIaXN0b3JpY01lYXN1cmVPZigibWVhc3VyZSBuYW1lIiwgZHVyYXRpb24pOiBtZWFzdXJlIGluIHRoZSBwYXRpZW50IGhpc3RvcnkgZHVyaW5nIGR1cmF0aW9uCgovLyBQYXRpZW50SGFzRGlhZ25vc3RpYygiRGlhZ25vc3RpYyBuYW1lIiApOiBEaWFnbm9zdGljIGluIHRoZSBlbmNvdW50ZXIKCi8vIFBhdGllbnRIYXNIaXN0b3J5T2ZEaWFnbm9zdGljKCJEaWFnbm9zdGljIG5hbWUiLCBkdXJhdGlvbiApOiBEaWFnbm9zdGljIGluIHRoZSBwYXRpZW50IGhpc3RvcnkgZHVyaW5nIGR1cmF0aW9uCgovLyBQYXRpZW50SGFzUHJvcG9zZWRvckNvbmZpcm1lZERpYW5vc3RpYygiRGlhZ25vc3RpYyBuYW1lIiApOiBEaWFnbm9zdGljIGluIHRoZSBlbmNvdW50ZXIKCi8vIFBhdGllbnRIYXNIaXN0b3J5T2ZQcm9wb3NlZG9yQ29uZmlybWVkRGlhbm9zdGljKCJEaWFnbm9zdGljIG5hbWUiLCBkdXJhdGlvbiApOiBEaWFnbm9zdGljIGluIHRoZSBwYXRpZW50IGhpc3RvcnkgZHVyaW5nIGR1cmF0aW9uCgovLyBQYXRpZW50WlNjb3JlV2ZBKHdpZWdodCwgYWdlKQoKLy8gUGF0aWVudFdlaWdodEZyb21XZkEoYWdlLCBNdWFjKQo="
        }
    ]
}