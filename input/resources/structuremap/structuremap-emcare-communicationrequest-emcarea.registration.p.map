map 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureMap/structuremap-emcare-communicationrequest-emcarea.registration.p' = 'emcare-communicationrequest-EmCareA.Registration.P'

uses 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/Questionnaire/questionnaire-emcarea.registration.p' alias 'emcarea.registration.p' as source
uses 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/Profile/profile-emcare-communicationrequest' alias 'emcare-communicationrequest' as target
group  main(
	source qr : 'emcarea.registration.p',
	target tgt : 'emcare-communicationrequest'
) {
	qr.item as item then {
		item.answer first as a where item.linkId = 'EmCare.A.DE38'  then { a -> tgt.medium = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/codesystem-emcare-custom-codes' 'EmCare.A.DE38-1'; } 'EmCare.A.DE38';
		item.answer first as a where item.linkId = 'EmCare.A.DE46'  then { a -> tgt.recipient = a 'EmCare.A.DE46-1'; } 'EmCare.A.DE46';
	} 'itemsemcarea.registration.p-emcare-communicationrequest';
} 

